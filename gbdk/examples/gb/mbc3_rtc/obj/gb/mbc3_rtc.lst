                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Mac OS X ppc)
                                      4 ;--------------------------------------------------------
                                      5 	.module mbc3_rtc
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl __current_ram_bank
                                     11 	.globl _RTC_VALUE_REG
                                     12 	.globl _RTC_LATCH_REG
                                     13 	.globl _RTC_SELECT_REG
                                     14 	.globl _RTC_GET
                                     15 	.globl _RTC_SET
                                     16 	.globl _RTC_START
                                     17 ;--------------------------------------------------------
                                     18 ; special function registers
                                     19 ;--------------------------------------------------------
                                     20 ;--------------------------------------------------------
                                     21 ; ram data
                                     22 ;--------------------------------------------------------
                                     23 	.area _DATA
                         00004000    24 _RTC_SELECT_REG	=	0x4000
                         00006000    25 _RTC_LATCH_REG	=	0x6000
                         0000A000    26 _RTC_VALUE_REG	=	0xa000
    00000000                         27 __current_ram_bank::
    00000000                         28 	.ds 1
                                     29 ;--------------------------------------------------------
                                     30 ; ram data
                                     31 ;--------------------------------------------------------
                                     32 	.area _INITIALIZED
                                     33 ;--------------------------------------------------------
                                     34 ; absolute external ram data
                                     35 ;--------------------------------------------------------
                                     36 	.area _DABS (ABS)
                                     37 ;--------------------------------------------------------
                                     38 ; global & static initialisations
                                     39 ;--------------------------------------------------------
                                     40 	.area _HOME
                                     41 	.area _GSINIT
                                     42 	.area _GSFINAL
                                     43 	.area _GSINIT
                                     44 ;--------------------------------------------------------
                                     45 ; Home
                                     46 ;--------------------------------------------------------
                                     47 	.area _HOME
                                     48 	.area _HOME
                                     49 ;--------------------------------------------------------
                                     50 ; code
                                     51 ;--------------------------------------------------------
                                     52 	.area _CODE
                                     53 ;src/mbc3_rtc.c:7: uint16_t RTC_GET(const rtc_dateparts_e part) {
                                     54 ;	---------------------------------
                                     55 ; Function RTC_GET
                                     56 ; ---------------------------------
    00000000                         57 _RTC_GET::
    00000000 5F               [ 4]   58 	ld	e, a
                                     59 ;src/mbc3_rtc.h:27: inline void SWITCH_RAM_BANK(uint8_t bank, uint8_t mask) { SWITCH_RAM(_current_ram_bank = ((_current_ram_bank & ~mask) | (bank & mask))); }
    00000001 21r00r00         [12]   60 	ld	hl, #__current_ram_bank
    00000004 7E               [ 8]   61 	ld	a, (hl)
    00000005 E6 F0            [ 8]   62 	and	a, #0xf0
    00000007 4F               [ 4]   63 	ld	c, a
    00000008 7B               [ 4]   64 	ld	a, e
    00000009 E6 0F            [ 8]   65 	and	a, #0x0f
    0000000B B1               [ 4]   66 	or	a, c
    0000000C 77               [ 8]   67 	ld	(hl), a
    0000000D EAr00r00         [16]   68 	ld	(#_rRAMB),a
                                     69 ;src/mbc3_rtc.c:10: v = RTC_VALUE_REG;
    00000010 FAr00r00         [16]   70 	ld	a, (_RTC_VALUE_REG)
    00000013 4F               [ 4]   71 	ld	c, a
    00000014 06 00            [ 8]   72 	ld	b, #0x00
                                     73 ;src/mbc3_rtc.c:11: if (part == RTC_VALUE_DAY) {
    00000016 7B               [ 4]   74 	ld	a, e
    00000017 D6 0B            [ 8]   75 	sub	a, #0x0b
    00000019 C0               [20]   76 	ret	NZ
                                     77 ;src/mbc3_rtc.h:27: inline void SWITCH_RAM_BANK(uint8_t bank, uint8_t mask) { SWITCH_RAM(_current_ram_bank = ((_current_ram_bank & ~mask) | (bank & mask))); }
    0000001A 21r00r00         [12]   78 	ld	hl, #__current_ram_bank
    0000001D 7E               [ 8]   79 	ld	a, (hl)
    0000001E E6 F0            [ 8]   80 	and	a, #0xf0
    00000020 F6 0C            [ 8]   81 	or	a, #0x0c
    00000022 77               [ 8]   82 	ld	(hl), a
    00000023 EAr00r00         [16]   83 	ld	(#_rRAMB),a
                                     84 ;src/mbc3_rtc.c:13: if (RTC_VALUE_REG & 0x01) v |= 0x0100u;
    00000026 FAr00r00         [16]   85 	ld	a, (_RTC_VALUE_REG)
    00000029 0F               [ 4]   86 	rrca
    0000002A D0               [20]   87 	ret	NC
    0000002B 06 01            [ 8]   88 	ld	b, #0x01
                                     89 ;src/mbc3_rtc.c:15: return v;
                                     90 ;src/mbc3_rtc.c:16: }
    0000002D C9               [16]   91 	ret
                                     92 ;src/mbc3_rtc.c:18: void RTC_SET(const rtc_dateparts_e part, const uint16_t v) {
                                     93 ;	---------------------------------
                                     94 ; Function RTC_SET
                                     95 ; ---------------------------------
    0000002E                         96 _RTC_SET::
    0000002E 4F               [ 4]   97 	ld	c, a
                                     98 ;src/mbc3_rtc.h:27: inline void SWITCH_RAM_BANK(uint8_t bank, uint8_t mask) { SWITCH_RAM(_current_ram_bank = ((_current_ram_bank & ~mask) | (bank & mask))); }
    0000002F 21r00r00         [12]   99 	ld	hl, #__current_ram_bank
    00000032 7E               [ 8]  100 	ld	a, (hl)
    00000033 E6 F0            [ 8]  101 	and	a, #0xf0
    00000035 47               [ 4]  102 	ld	b, a
    00000036 79               [ 4]  103 	ld	a, c
    00000037 E6 0F            [ 8]  104 	and	a, #0x0f
    00000039 B0               [ 4]  105 	or	a, b
    0000003A 77               [ 8]  106 	ld	(hl), a
    0000003B EAr00r00         [16]  107 	ld	(#_rRAMB),a
                                    108 ;src/mbc3_rtc.c:20: RTC_VALUE_REG = v;
    0000003E 21r00r00         [12]  109 	ld	hl, #_RTC_VALUE_REG
    00000041 73               [ 8]  110 	ld	(hl), e
                                    111 ;src/mbc3_rtc.c:21: if (part == RTC_VALUE_DAY) {
    00000042 79               [ 4]  112 	ld	a, c
    00000043 D6 0B            [ 8]  113 	sub	a, #0x0b
    00000045 C0               [20]  114 	ret	NZ
                                    115 ;src/mbc3_rtc.h:27: inline void SWITCH_RAM_BANK(uint8_t bank, uint8_t mask) { SWITCH_RAM(_current_ram_bank = ((_current_ram_bank & ~mask) | (bank & mask))); }
    00000046 21r00r00         [12]  116 	ld	hl, #__current_ram_bank
    00000049 7E               [ 8]  117 	ld	a, (hl)
    0000004A E6 F0            [ 8]  118 	and	a, #0xf0
    0000004C F6 0C            [ 8]  119 	or	a, #0x0c
    0000004E 77               [ 8]  120 	ld	(hl), a
    0000004F EAr00r00         [16]  121 	ld	(#_rRAMB),a
                                    122 ;src/mbc3_rtc.c:23: RTC_VALUE_REG = (RTC_VALUE_REG & 0x0e) | (uint8_t)((v >> 8) & 0x01);
    00000052 FAr00r00         [16]  123 	ld	a, (_RTC_VALUE_REG)
    00000055 E6 0E            [ 8]  124 	and	a, #0x0e
    00000057 4F               [ 4]  125 	ld	c, a
    00000058 7A               [ 4]  126 	ld	a, d
    00000059 E6 01            [ 8]  127 	and	a, #0x01
    0000005B B1               [ 4]  128 	or	a, c
    0000005C EAr00r00         [16]  129 	ld	(#_RTC_VALUE_REG),a
                                    130 ;src/mbc3_rtc.c:25: }
    0000005F C9               [16]  131 	ret
                                    132 ;src/mbc3_rtc.c:27: void RTC_START(const uint8_t start) {
                                    133 ;	---------------------------------
                                    134 ; Function RTC_START
                                    135 ; ---------------------------------
    00000060                        136 _RTC_START::
    00000060 4F               [ 4]  137 	ld	c, a
    00000061 21r00r00         [12]  138 	ld	hl, #__current_ram_bank
    00000064 7E               [ 8]  139 	ld	a, (hl)
    00000065 E6 F0            [ 8]  140 	and	a, #0xf0
    00000067 F6 0C            [ 8]  141 	or	a, #0x0c
    00000069 77               [ 8]  142 	ld	(hl), a
    0000006A EAr00r00         [16]  143 	ld	(#_rRAMB),a
                                    144 ;src/mbc3_rtc.c:29: if (start) RTC_VALUE_REG &= ~RTC_TIMER_STOP; else RTC_VALUE_REG |= RTC_TIMER_STOP;
    0000006D 79               [ 4]  145 	ld	a, c
    0000006E B7               [ 4]  146 	or	a, a
    0000006F 28 08            [12]  147 	jr	Z, 00102$
    00000071 21r00r00         [12]  148 	ld	hl, #_RTC_VALUE_REG
    00000074 7E               [ 8]  149 	ld	a, (hl)
    00000075 E6 BF            [ 8]  150 	and	a, #0xbf
    00000077 77               [ 8]  151 	ld	(hl), a
    00000078 C9               [16]  152 	ret
    00000079                        153 00102$:
    00000079 21r00r00         [12]  154 	ld	hl, #_RTC_VALUE_REG
    0000007C 7E               [ 8]  155 	ld	a, (hl)
    0000007D F6 40            [ 8]  156 	or	a, #0x40
    0000007F 77               [ 8]  157 	ld	(hl), a
                                    158 ;src/mbc3_rtc.c:30: }
    00000080 C9               [16]  159 	ret
                                    160 	.area _CODE
                                    161 	.area _INITIALIZER
                                    162 	.area _CABS (ABS)
