                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Mac OS X ppc)
                                      4 ;--------------------------------------------------------
                                      5 	.module joytest
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _reset_object_pos
                                     12 	.globl _draw_disabled
                                     13 	.globl _draw_buttons
                                     14 	.globl _fill_rect_compat
                                     15 	.globl _set_tile_map_compat
                                     16 	.globl _set_tile_2bpp_data
                                     17 	.globl _joypad_ex
                                     18 	.globl _joypad_init
                                     19 	.globl _joypad
                                     20 	.globl _vsync
                                     21 	.globl _joy
                                     22 	.globl _old_joy
                                     23 	.globl _isSGB
                                     24 	.globl _toggle
                                     25 	.globl _joypads
                                     26 	.globl _old_joypads
                                     27 ;--------------------------------------------------------
                                     28 ; special function registers
                                     29 ;--------------------------------------------------------
                         00000000    30 _GG_STATE	=	0x0000
                         00000001    31 _GG_EXT_7BIT	=	0x0001
                         00000002    32 _GG_EXT_CTL	=	0x0002
                         00000003    33 _GG_SIO_SEND	=	0x0003
                         00000004    34 _GG_SIO_RECV	=	0x0004
                         00000005    35 _GG_SIO_CTL	=	0x0005
                         00000006    36 _GG_SOUND_PAN	=	0x0006
                         0000003E    37 _MEMORY_CTL	=	0x003e
                         0000003F    38 _JOY_CTL	=	0x003f
                         0000007E    39 _VCOUNTER	=	0x007e
                         0000007F    40 _PSG	=	0x007f
                         0000007F    41 _HCOUNTER	=	0x007f
                         000000BE    42 _VDP_DATA	=	0x00be
                         000000BF    43 _VDP_CMD	=	0x00bf
                         000000BF    44 _VDP_STATUS	=	0x00bf
                         000000DC    45 _JOY_PORT1	=	0x00dc
                         000000DD    46 _JOY_PORT2	=	0x00dd
                         000000F0    47 _FMADDRESS	=	0x00f0
                         000000F1    48 _FMDATA	=	0x00f1
                         000000F2    49 _AUDIOCTRL	=	0x00f2
                                     50 ;--------------------------------------------------------
                                     51 ; ram data
                                     52 ;--------------------------------------------------------
                                     53 	.area _DATA
                         0000FFFC    54 _RAM_CONTROL	=	0xfffc
                         0000FFF8    55 _GLASSES_3D	=	0xfff8
                         0000FFFD    56 _MAP_FRAME0	=	0xfffd
                         0000FFFE    57 _MAP_FRAME1	=	0xfffe
                         0000FFFF    58 _MAP_FRAME2	=	0xffff
    00000000                         59 _old_joypads::
    00000000                         60 	.ds 5
    00000005                         61 _joypads::
    00000005                         62 	.ds 5
                                     63 ;--------------------------------------------------------
                                     64 ; ram data
                                     65 ;--------------------------------------------------------
                                     66 	.area _INITIALIZED
    00000000                         67 _toggle::
    00000000                         68 	.ds 1
    00000001                         69 _isSGB::
    00000001                         70 	.ds 1
    00000002                         71 _old_joy::
    00000002                         72 	.ds 1
    00000003                         73 _joy::
    00000003                         74 	.ds 1
                                     75 ;--------------------------------------------------------
                                     76 ; absolute external ram data
                                     77 ;--------------------------------------------------------
                                     78 	.area _DABS (ABS)
                                     79 ;--------------------------------------------------------
                                     80 ; global & static initialisations
                                     81 ;--------------------------------------------------------
                                     82 	.area _HOME
                                     83 	.area _GSINIT
                                     84 	.area _GSFINAL
                                     85 	.area _GSINIT
                                     86 ;--------------------------------------------------------
                                     87 ; Home
                                     88 ;--------------------------------------------------------
                                     89 	.area _HOME
                                     90 	.area _HOME
                                     91 ;--------------------------------------------------------
                                     92 ; code
                                     93 ;--------------------------------------------------------
                                     94 	.area _CODE
                                     95 ;src/joytest.c:13: void draw_buttons(uint8_t state, uint8_t x, uint8_t y) {
                                     96 ;	---------------------------------
                                     97 ; Function draw_buttons
                                     98 ; ---------------------------------
    00000000                         99 _draw_buttons::
    00000000 DD E5            [15]  100 	push	ix
    00000002 DD 21 00 00      [14]  101 	ld	ix,#0
    00000006 DD 39            [15]  102 	add	ix,sp
    00000008 F5               [11]  103 	push	af
    00000009 47               [ 4]  104 	ld	b, a
    0000000A DD 75 FF         [19]  105 	ld	-1 (ix), l
                                    106 ;src/joytest.c:14: set_bkg_based_tiles(x,      y, 2, 2, (state & J_UP)     ? pressed_buttons[0] : normal_buttons[0], 1);
    0000000D CB 40            [ 8]  107 	bit	0, b
    0000000F 28 05            [12]  108 	jr	Z, 00111$
    00000011 11r00r00         [10]  109 	ld	de, #_pressed_buttons+0
    00000014 18 03            [12]  110 	jr	00112$
    00000016                        111 00111$:
    00000016 11r00r00         [10]  112 	ld	de, #_normal_buttons+0
    00000019                        113 00112$:
    00000019 DD 4E 04         [19]  114 	ld	c, 4 (ix)
                                    115 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000001C 21r00r00         [10]  116 	ld	hl, #__map_tile_offset
    0000001F 36 01            [10]  117 	ld	(hl), #0x01
                                    118 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000021 C5               [11]  119 	push	bc
    00000022 D5               [11]  120 	push	de
    00000023 21 02 02         [10]  121 	ld	hl, #0x202
    00000026 E5               [11]  122 	push	hl
    00000027 61               [ 4]  123 	ld	h, c
    00000028 DD 6E FF         [19]  124 	ld	l, -1 (ix)
    0000002B E5               [11]  125 	push	hl
    0000002C CDr00r00         [17]  126 	call	_set_tile_map_compat
    0000002F C1               [10]  127 	pop	bc
                                    128 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000030 AF               [ 4]  129 	xor	a, a
    00000031 32r00r00         [13]  130 	ld	(__map_tile_offset+0), a
                                    131 ;src/joytest.c:15: set_bkg_based_tiles(x + 2,  y, 2, 2, (state & J_DOWN)   ? pressed_buttons[1] : normal_buttons[1], 1);
    00000034 CB 48            [ 8]  132 	bit	1, b
    00000036 28 05            [12]  133 	jr	Z, 00113$
    00000038 11r04r00         [10]  134 	ld	de, #_pressed_buttons+4
    0000003B 18 03            [12]  135 	jr	00114$
    0000003D                        136 00113$:
    0000003D 11r04r00         [10]  137 	ld	de, #_normal_buttons+4
    00000040                        138 00114$:
    00000040 DD 7E FF         [19]  139 	ld	a, -1 (ix)
    00000043 DD 77 FE         [19]  140 	ld	-2 (ix), a
    00000046 3C               [ 4]  141 	inc	a
    00000047 3C               [ 4]  142 	inc	a
                                    143 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    00000048 FD 21r00r00      [14]  144 	ld	iy, #__map_tile_offset
    0000004C FD 36 00 01      [19]  145 	ld	0 (iy), #0x01
                                    146 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000050 C5               [11]  147 	push	bc
    00000051 D5               [11]  148 	push	de
    00000052 26 02            [ 7]  149 	ld	h, #0x02
    00000054 E5               [11]  150 	push	hl
    00000055 33               [ 6]  151 	inc	sp
    00000056 26 02            [ 7]  152 	ld	h, #0x02
    00000058 E5               [11]  153 	push	hl
    00000059 33               [ 6]  154 	inc	sp
    0000005A 61               [ 4]  155 	ld	h, c
    0000005B E5               [11]  156 	push	hl
    0000005C 33               [ 6]  157 	inc	sp
    0000005D F5               [11]  158 	push	af
    0000005E 33               [ 6]  159 	inc	sp
    0000005F CDr00r00         [17]  160 	call	_set_tile_map_compat
    00000062 C1               [10]  161 	pop	bc
                                    162 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000063 AF               [ 4]  163 	xor	a, a
    00000064 32r00r00         [13]  164 	ld	(__map_tile_offset+0), a
                                    165 ;src/joytest.c:16: set_bkg_based_tiles(x + 4,  y, 2, 2, (state & J_LEFT)   ? pressed_buttons[2] : normal_buttons[2], 1);
    00000067 CB 50            [ 8]  166 	bit	2, b
    00000069 28 05            [12]  167 	jr	Z, 00115$
    0000006B 11r08r00         [10]  168 	ld	de, #_pressed_buttons+8
    0000006E 18 03            [12]  169 	jr	00116$
    00000070                        170 00115$:
    00000070 11r08r00         [10]  171 	ld	de, #_normal_buttons+8
    00000073                        172 00116$:
    00000073 DD 7E FE         [19]  173 	ld	a, -2 (ix)
    00000076 3C               [ 4]  174 	inc	a
    00000077 3C               [ 4]  175 	inc	a
    00000078 3C               [ 4]  176 	inc	a
    00000079 3C               [ 4]  177 	inc	a
                                    178 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000007A FD 21r00r00      [14]  179 	ld	iy, #__map_tile_offset
    0000007E FD 36 00 01      [19]  180 	ld	0 (iy), #0x01
                                    181 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000082 C5               [11]  182 	push	bc
    00000083 D5               [11]  183 	push	de
    00000084 26 02            [ 7]  184 	ld	h, #0x02
    00000086 E5               [11]  185 	push	hl
    00000087 33               [ 6]  186 	inc	sp
    00000088 26 02            [ 7]  187 	ld	h, #0x02
    0000008A E5               [11]  188 	push	hl
    0000008B 33               [ 6]  189 	inc	sp
    0000008C 61               [ 4]  190 	ld	h, c
    0000008D E5               [11]  191 	push	hl
    0000008E 33               [ 6]  192 	inc	sp
    0000008F F5               [11]  193 	push	af
    00000090 33               [ 6]  194 	inc	sp
    00000091 CDr00r00         [17]  195 	call	_set_tile_map_compat
    00000094 C1               [10]  196 	pop	bc
                                    197 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000095 AF               [ 4]  198 	xor	a, a
    00000096 32r00r00         [13]  199 	ld	(__map_tile_offset+0), a
                                    200 ;src/joytest.c:17: set_bkg_based_tiles(x + 6,  y, 2, 2, (state & J_RIGHT)  ? pressed_buttons[3] : normal_buttons[3], 1);
    00000099 CB 58            [ 8]  201 	bit	3, b
    0000009B 28 05            [12]  202 	jr	Z, 00117$
    0000009D 11r0Cr00         [10]  203 	ld	de, #_pressed_buttons+12
    000000A0 18 03            [12]  204 	jr	00118$
    000000A2                        205 00117$:
    000000A2 11r0Cr00         [10]  206 	ld	de, #_normal_buttons+12
    000000A5                        207 00118$:
    000000A5 DD 7E FE         [19]  208 	ld	a, -2 (ix)
    000000A8 C6 06            [ 7]  209 	add	a, #0x06
                                    210 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    000000AA FD 21r00r00      [14]  211 	ld	iy, #__map_tile_offset
    000000AE FD 36 00 01      [19]  212 	ld	0 (iy), #0x01
                                    213 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    000000B2 C5               [11]  214 	push	bc
    000000B3 D5               [11]  215 	push	de
    000000B4 26 02            [ 7]  216 	ld	h, #0x02
    000000B6 E5               [11]  217 	push	hl
    000000B7 33               [ 6]  218 	inc	sp
    000000B8 26 02            [ 7]  219 	ld	h, #0x02
    000000BA E5               [11]  220 	push	hl
    000000BB 33               [ 6]  221 	inc	sp
    000000BC 61               [ 4]  222 	ld	h, c
    000000BD E5               [11]  223 	push	hl
    000000BE 33               [ 6]  224 	inc	sp
    000000BF F5               [11]  225 	push	af
    000000C0 33               [ 6]  226 	inc	sp
    000000C1 CDr00r00         [17]  227 	call	_set_tile_map_compat
    000000C4 C1               [10]  228 	pop	bc
                                    229 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    000000C5 AF               [ 4]  230 	xor	a, a
    000000C6 32r00r00         [13]  231 	ld	(__map_tile_offset+0), a
                                    232 ;src/joytest.c:18: set_bkg_based_tiles(x + 8,  y, 2, 2, (state & J_A)      ? pressed_buttons[4] : normal_buttons[4], 1);
    000000C9 CB 68            [ 8]  233 	bit	5, b
    000000CB 28 05            [12]  234 	jr	Z, 00119$
    000000CD 11r10r00         [10]  235 	ld	de, #_pressed_buttons+16
    000000D0 18 03            [12]  236 	jr	00120$
    000000D2                        237 00119$:
    000000D2 11r10r00         [10]  238 	ld	de, #_normal_buttons+16
    000000D5                        239 00120$:
    000000D5 DD 7E FE         [19]  240 	ld	a, -2 (ix)
    000000D8 C6 08            [ 7]  241 	add	a, #0x08
                                    242 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    000000DA FD 21r00r00      [14]  243 	ld	iy, #__map_tile_offset
    000000DE FD 36 00 01      [19]  244 	ld	0 (iy), #0x01
                                    245 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    000000E2 C5               [11]  246 	push	bc
    000000E3 D5               [11]  247 	push	de
    000000E4 26 02            [ 7]  248 	ld	h, #0x02
    000000E6 E5               [11]  249 	push	hl
    000000E7 33               [ 6]  250 	inc	sp
    000000E8 26 02            [ 7]  251 	ld	h, #0x02
    000000EA E5               [11]  252 	push	hl
    000000EB 33               [ 6]  253 	inc	sp
    000000EC 61               [ 4]  254 	ld	h, c
    000000ED E5               [11]  255 	push	hl
    000000EE 33               [ 6]  256 	inc	sp
    000000EF F5               [11]  257 	push	af
    000000F0 33               [ 6]  258 	inc	sp
    000000F1 CDr00r00         [17]  259 	call	_set_tile_map_compat
    000000F4 C1               [10]  260 	pop	bc
                                    261 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    000000F5 AF               [ 4]  262 	xor	a, a
    000000F6 32r00r00         [13]  263 	ld	(__map_tile_offset+0), a
                                    264 ;src/joytest.c:19: set_bkg_based_tiles(x + 10, y, 2, 2, (state & J_B)      ? pressed_buttons[5] : normal_buttons[5], 1);
    000000F9 CB 60            [ 8]  265 	bit	4, b
    000000FB 28 05            [12]  266 	jr	Z, 00121$
    000000FD 11r14r00         [10]  267 	ld	de, #_pressed_buttons+20
    00000100 18 03            [12]  268 	jr	00122$
    00000102                        269 00121$:
    00000102 11r14r00         [10]  270 	ld	de, #_normal_buttons+20
    00000105                        271 00122$:
    00000105 DD 7E FE         [19]  272 	ld	a, -2 (ix)
    00000108 C6 0A            [ 7]  273 	add	a, #0x0a
                                    274 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000010A FD 21r00r00      [14]  275 	ld	iy, #__map_tile_offset
    0000010E FD 36 00 01      [19]  276 	ld	0 (iy), #0x01
                                    277 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000112 C5               [11]  278 	push	bc
    00000113 D5               [11]  279 	push	de
    00000114 26 02            [ 7]  280 	ld	h, #0x02
    00000116 E5               [11]  281 	push	hl
    00000117 33               [ 6]  282 	inc	sp
    00000118 26 02            [ 7]  283 	ld	h, #0x02
    0000011A E5               [11]  284 	push	hl
    0000011B 33               [ 6]  285 	inc	sp
    0000011C 61               [ 4]  286 	ld	h, c
    0000011D E5               [11]  287 	push	hl
    0000011E 33               [ 6]  288 	inc	sp
    0000011F F5               [11]  289 	push	af
    00000120 33               [ 6]  290 	inc	sp
    00000121 CDr00r00         [17]  291 	call	_set_tile_map_compat
    00000124 C1               [10]  292 	pop	bc
                                    293 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000125 AF               [ 4]  294 	xor	a, a
    00000126 32r00r00         [13]  295 	ld	(__map_tile_offset+0), a
                                    296 ;src/joytest.c:20: set_bkg_based_tiles(x + 12, y, 2, 2, (state & J_START)  ? pressed_buttons[6] : normal_buttons[6], 1);
    00000129 CB 70            [ 8]  297 	bit	6, b
    0000012B 28 05            [12]  298 	jr	Z, 00123$
    0000012D 11r18r00         [10]  299 	ld	de, #_pressed_buttons+24
    00000130 18 03            [12]  300 	jr	00124$
    00000132                        301 00123$:
    00000132 11r18r00         [10]  302 	ld	de, #_normal_buttons+24
    00000135                        303 00124$:
    00000135 DD 7E FE         [19]  304 	ld	a, -2 (ix)
    00000138 C6 0C            [ 7]  305 	add	a, #0x0c
                                    306 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000013A FD 21r00r00      [14]  307 	ld	iy, #__map_tile_offset
    0000013E FD 36 00 01      [19]  308 	ld	0 (iy), #0x01
                                    309 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000142 C5               [11]  310 	push	bc
    00000143 D5               [11]  311 	push	de
    00000144 26 02            [ 7]  312 	ld	h, #0x02
    00000146 E5               [11]  313 	push	hl
    00000147 33               [ 6]  314 	inc	sp
    00000148 26 02            [ 7]  315 	ld	h, #0x02
    0000014A E5               [11]  316 	push	hl
    0000014B 33               [ 6]  317 	inc	sp
    0000014C 61               [ 4]  318 	ld	h, c
    0000014D E5               [11]  319 	push	hl
    0000014E 33               [ 6]  320 	inc	sp
    0000014F F5               [11]  321 	push	af
    00000150 33               [ 6]  322 	inc	sp
    00000151 CDr00r00         [17]  323 	call	_set_tile_map_compat
    00000154 C1               [10]  324 	pop	bc
                                    325 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000155 AF               [ 4]  326 	xor	a, a
    00000156 32r00r00         [13]  327 	ld	(__map_tile_offset+0), a
                                    328 ;src/joytest.c:21: set_bkg_based_tiles(x + 14, y, 2, 2, (state & J_SELECT) ? pressed_buttons[7] : normal_buttons[7], 1);
    00000159 CB 78            [ 8]  329 	bit	7, b
    0000015B 28 05            [12]  330 	jr	Z, 00125$
    0000015D 11r1Cr00         [10]  331 	ld	de, #_pressed_buttons+28
    00000160 18 03            [12]  332 	jr	00126$
    00000162                        333 00125$:
    00000162 11r1Cr00         [10]  334 	ld	de, #_normal_buttons+28
    00000165                        335 00126$:
    00000165 DD 7E FE         [19]  336 	ld	a, -2 (ix)
    00000168 C6 0E            [ 7]  337 	add	a, #0x0e
                                    338 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000016A FD 21r00r00      [14]  339 	ld	iy, #__map_tile_offset
    0000016E FD 36 00 01      [19]  340 	ld	0 (iy), #0x01
                                    341 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000172 D5               [11]  342 	push	de
    00000173 26 02            [ 7]  343 	ld	h, #0x02
    00000175 E5               [11]  344 	push	hl
    00000176 33               [ 6]  345 	inc	sp
    00000177 26 02            [ 7]  346 	ld	h, #0x02
    00000179 E5               [11]  347 	push	hl
    0000017A 33               [ 6]  348 	inc	sp
    0000017B 61               [ 4]  349 	ld	h, c
    0000017C E5               [11]  350 	push	hl
    0000017D 33               [ 6]  351 	inc	sp
    0000017E F5               [11]  352 	push	af
    0000017F 33               [ 6]  353 	inc	sp
    00000180 CDr00r00         [17]  354 	call	_set_tile_map_compat
                                    355 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000183 AF               [ 4]  356 	xor	a, a
    00000184 32r00r00         [13]  357 	ld	(__map_tile_offset+0), a
                                    358 ;src/joytest.c:21: set_bkg_based_tiles(x + 14, y, 2, 2, (state & J_SELECT) ? pressed_buttons[7] : normal_buttons[7], 1);
                                    359 ;src/joytest.c:22: }
    00000187 DD F9            [10]  360 	ld	sp, ix
    00000189 DD E1            [14]  361 	pop	ix
    0000018B E1               [10]  362 	pop	hl
    0000018C 33               [ 6]  363 	inc	sp
    0000018D E9               [ 4]  364 	jp	(hl)
                                    365 ;src/joytest.c:24: void draw_disabled(uint8_t x, uint8_t y) {
                                    366 ;	---------------------------------
                                    367 ; Function draw_disabled
                                    368 ; ---------------------------------
    0000018E                        369 _draw_disabled::
    0000018E 4F               [ 4]  370 	ld	c, a
    0000018F 45               [ 4]  371 	ld	b, l
                                    372 ;src/joytest.c:25: set_bkg_based_tiles(x,      y, 2, 2, disabled_buttons[0], 1);
                                    373 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    00000190 21r00r00         [10]  374 	ld	hl, #__map_tile_offset
    00000193 36 01            [10]  375 	ld	(hl), #0x01
                                    376 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000195 C5               [11]  377 	push	bc
    00000196 21r00r00         [10]  378 	ld	hl, #_disabled_buttons
    00000199 E5               [11]  379 	push	hl
    0000019A 21 02 02         [10]  380 	ld	hl, #0x202
    0000019D E5               [11]  381 	push	hl
    0000019E C5               [11]  382 	push	bc
    0000019F CDr00r00         [17]  383 	call	_set_tile_map_compat
    000001A2 C1               [10]  384 	pop	bc
                                    385 ;src/joytest.c:26: set_bkg_based_tiles(x + 2,  y, 2, 2, disabled_buttons[1], 1);
    000001A3 11r04r00         [10]  386 	ld	de, #_disabled_buttons + 4
    000001A6 79               [ 4]  387 	ld	a, c
    000001A7 3C               [ 4]  388 	inc	a
    000001A8 3C               [ 4]  389 	inc	a
                                    390 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    000001A9 FD 21r00r00      [14]  391 	ld	iy, #__map_tile_offset
    000001AD FD 36 00 01      [19]  392 	ld	0 (iy), #0x01
                                    393 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    000001B1 C5               [11]  394 	push	bc
    000001B2 D5               [11]  395 	push	de
    000001B3 26 02            [ 7]  396 	ld	h, #0x02
    000001B5 E5               [11]  397 	push	hl
    000001B6 33               [ 6]  398 	inc	sp
    000001B7 26 02            [ 7]  399 	ld	h, #0x02
    000001B9 68               [ 4]  400 	ld	l, b
    000001BA E5               [11]  401 	push	hl
    000001BB F5               [11]  402 	push	af
    000001BC 33               [ 6]  403 	inc	sp
    000001BD CDr00r00         [17]  404 	call	_set_tile_map_compat
    000001C0 C1               [10]  405 	pop	bc
                                    406 ;src/joytest.c:27: set_bkg_based_tiles(x + 4,  y, 2, 2, disabled_buttons[2], 1);
    000001C1 11r08r00         [10]  407 	ld	de, #_disabled_buttons + 8
    000001C4 79               [ 4]  408 	ld	a, c
    000001C5 3C               [ 4]  409 	inc	a
    000001C6 3C               [ 4]  410 	inc	a
    000001C7 3C               [ 4]  411 	inc	a
    000001C8 3C               [ 4]  412 	inc	a
                                    413 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    000001C9 FD 21r00r00      [14]  414 	ld	iy, #__map_tile_offset
    000001CD FD 36 00 01      [19]  415 	ld	0 (iy), #0x01
                                    416 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    000001D1 C5               [11]  417 	push	bc
    000001D2 D5               [11]  418 	push	de
    000001D3 26 02            [ 7]  419 	ld	h, #0x02
    000001D5 E5               [11]  420 	push	hl
    000001D6 33               [ 6]  421 	inc	sp
    000001D7 26 02            [ 7]  422 	ld	h, #0x02
    000001D9 68               [ 4]  423 	ld	l, b
    000001DA E5               [11]  424 	push	hl
    000001DB F5               [11]  425 	push	af
    000001DC 33               [ 6]  426 	inc	sp
    000001DD CDr00r00         [17]  427 	call	_set_tile_map_compat
    000001E0 C1               [10]  428 	pop	bc
                                    429 ;src/joytest.c:28: set_bkg_based_tiles(x + 6,  y, 2, 2, disabled_buttons[3], 1);
    000001E1 11r0Cr00         [10]  430 	ld	de, #_disabled_buttons + 12
    000001E4 79               [ 4]  431 	ld	a, c
    000001E5 C6 06            [ 7]  432 	add	a, #0x06
                                    433 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    000001E7 FD 21r00r00      [14]  434 	ld	iy, #__map_tile_offset
    000001EB FD 36 00 01      [19]  435 	ld	0 (iy), #0x01
                                    436 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    000001EF C5               [11]  437 	push	bc
    000001F0 D5               [11]  438 	push	de
    000001F1 26 02            [ 7]  439 	ld	h, #0x02
    000001F3 E5               [11]  440 	push	hl
    000001F4 33               [ 6]  441 	inc	sp
    000001F5 26 02            [ 7]  442 	ld	h, #0x02
    000001F7 68               [ 4]  443 	ld	l, b
    000001F8 E5               [11]  444 	push	hl
    000001F9 F5               [11]  445 	push	af
    000001FA 33               [ 6]  446 	inc	sp
    000001FB CDr00r00         [17]  447 	call	_set_tile_map_compat
    000001FE C1               [10]  448 	pop	bc
                                    449 ;src/joytest.c:29: set_bkg_based_tiles(x + 8,  y, 2, 2, disabled_buttons[4], 1);
    000001FF 11r10r00         [10]  450 	ld	de, #_disabled_buttons + 16
    00000202 79               [ 4]  451 	ld	a, c
    00000203 C6 08            [ 7]  452 	add	a, #0x08
                                    453 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    00000205 FD 21r00r00      [14]  454 	ld	iy, #__map_tile_offset
    00000209 FD 36 00 01      [19]  455 	ld	0 (iy), #0x01
                                    456 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    0000020D C5               [11]  457 	push	bc
    0000020E D5               [11]  458 	push	de
    0000020F 26 02            [ 7]  459 	ld	h, #0x02
    00000211 E5               [11]  460 	push	hl
    00000212 33               [ 6]  461 	inc	sp
    00000213 26 02            [ 7]  462 	ld	h, #0x02
    00000215 68               [ 4]  463 	ld	l, b
    00000216 E5               [11]  464 	push	hl
    00000217 F5               [11]  465 	push	af
    00000218 33               [ 6]  466 	inc	sp
    00000219 CDr00r00         [17]  467 	call	_set_tile_map_compat
    0000021C C1               [10]  468 	pop	bc
                                    469 ;src/joytest.c:30: set_bkg_based_tiles(x + 10, y, 2, 2, disabled_buttons[5], 1);
    0000021D 11r14r00         [10]  470 	ld	de, #_disabled_buttons + 20
    00000220 79               [ 4]  471 	ld	a, c
    00000221 C6 0A            [ 7]  472 	add	a, #0x0a
                                    473 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    00000223 FD 21r00r00      [14]  474 	ld	iy, #__map_tile_offset
    00000227 FD 36 00 01      [19]  475 	ld	0 (iy), #0x01
                                    476 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    0000022B C5               [11]  477 	push	bc
    0000022C D5               [11]  478 	push	de
    0000022D 26 02            [ 7]  479 	ld	h, #0x02
    0000022F E5               [11]  480 	push	hl
    00000230 33               [ 6]  481 	inc	sp
    00000231 26 02            [ 7]  482 	ld	h, #0x02
    00000233 68               [ 4]  483 	ld	l, b
    00000234 E5               [11]  484 	push	hl
    00000235 F5               [11]  485 	push	af
    00000236 33               [ 6]  486 	inc	sp
    00000237 CDr00r00         [17]  487 	call	_set_tile_map_compat
    0000023A C1               [10]  488 	pop	bc
                                    489 ;src/joytest.c:31: set_bkg_based_tiles(x + 12, y, 2, 2, disabled_buttons[6], 1);
    0000023B 11r18r00         [10]  490 	ld	de, #_disabled_buttons + 24
    0000023E 79               [ 4]  491 	ld	a, c
    0000023F C6 0C            [ 7]  492 	add	a, #0x0c
                                    493 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    00000241 FD 21r00r00      [14]  494 	ld	iy, #__map_tile_offset
    00000245 FD 36 00 01      [19]  495 	ld	0 (iy), #0x01
                                    496 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000249 C5               [11]  497 	push	bc
    0000024A D5               [11]  498 	push	de
    0000024B 26 02            [ 7]  499 	ld	h, #0x02
    0000024D E5               [11]  500 	push	hl
    0000024E 33               [ 6]  501 	inc	sp
    0000024F 26 02            [ 7]  502 	ld	h, #0x02
    00000251 68               [ 4]  503 	ld	l, b
    00000252 E5               [11]  504 	push	hl
    00000253 F5               [11]  505 	push	af
    00000254 33               [ 6]  506 	inc	sp
    00000255 CDr00r00         [17]  507 	call	_set_tile_map_compat
    00000258 C1               [10]  508 	pop	bc
                                    509 ;src/joytest.c:32: set_bkg_based_tiles(x + 14, y, 2, 2, disabled_buttons[7], 1);
    00000259 11r1Cr00         [10]  510 	ld	de, #_disabled_buttons + 28
    0000025C 79               [ 4]  511 	ld	a, c
    0000025D C6 0E            [ 7]  512 	add	a, #0x0e
                                    513 ;../../../include/sms/sms.h:684: _map_tile_offset = base_tile;
    0000025F FD 21r00r00      [14]  514 	ld	iy, #__map_tile_offset
    00000263 FD 36 00 01      [19]  515 	ld	0 (iy), #0x01
                                    516 ;../../../include/sms/sms.h:685: set_tile_map_compat(x, y, w, h, tiles);
    00000267 D5               [11]  517 	push	de
    00000268 26 02            [ 7]  518 	ld	h, #0x02
    0000026A E5               [11]  519 	push	hl
    0000026B 33               [ 6]  520 	inc	sp
    0000026C 26 02            [ 7]  521 	ld	h, #0x02
    0000026E 68               [ 4]  522 	ld	l, b
    0000026F E5               [11]  523 	push	hl
    00000270 F5               [11]  524 	push	af
    00000271 33               [ 6]  525 	inc	sp
    00000272 CDr00r00         [17]  526 	call	_set_tile_map_compat
                                    527 ;../../../include/sms/sms.h:686: _map_tile_offset = 0;
    00000275 AF               [ 4]  528 	xor	a, a
    00000276 32r00r00         [13]  529 	ld	(__map_tile_offset+0), a
                                    530 ;src/joytest.c:32: set_bkg_based_tiles(x + 14, y, 2, 2, disabled_buttons[7], 1);
                                    531 ;src/joytest.c:33: }
    00000279 C9               [10]  532 	ret
                                    533 ;src/joytest.c:35: void reset_object_pos(void) {
                                    534 ;	---------------------------------
                                    535 ; Function reset_object_pos
                                    536 ; ---------------------------------
    0000027A                        537 _reset_object_pos::
    0000027A DD E5            [15]  538 	push	ix
    0000027C DD 21 00 00      [14]  539 	ld	ix,#0
    00000280 DD 39            [15]  540 	add	ix,sp
    00000282 3B               [ 6]  541 	dec	sp
                                    542 ;src/joytest.c:36: for (uint8_t i = 0; i < 4; i++) {
    00000283 0E 00            [ 7]  543 	ld	c, #0x00
    00000285                        544 00105$:
    00000285 79               [ 4]  545 	ld	a, c
    00000286 D6 04            [ 7]  546 	sub	a, #0x04
    00000288 30 36            [12]  547 	jr	NC, 00107$
                                    548 ;../../../include/sms/sms.h:815: shadow_OAM[0x41+(nb << 1)] = tile;
    0000028A 59               [ 4]  549 	ld	e, c
    0000028B 16 00            [ 7]  550 	ld	d, #0x00
    0000028D EB               [ 4]  551 	ex	de, hl
    0000028E 29               [11]  552 	add	hl, hl
    0000028F EB               [ 4]  553 	ex	de, hl
    00000290 21 41 00         [10]  554 	ld	hl, #0x0041
    00000293 19               [11]  555 	add	hl, de
    00000294 3Er00            [ 7]  556 	ld	a, #<(_shadow_OAM)
    00000296 85               [ 4]  557 	add	a, l
    00000297 6F               [ 4]  558 	ld	l, a
    00000298 3Es00            [ 7]  559 	ld	a, #>(_shadow_OAM)
    0000029A 8C               [ 4]  560 	adc	a, h
    0000029B 67               [ 4]  561 	ld	h, a
    0000029C 71               [ 7]  562 	ld	(hl), c
                                    563 ;src/joytest.c:39: DEVICE_SPRITE_PX_OFFSET_X + (i << 3) + ((DEVICE_SCREEN_PX_WIDTH - (4 * 8)) >> 1), 
    0000029D 79               [ 4]  564 	ld	a, c
    0000029E 87               [ 4]  565 	add	a, a
    0000029F 87               [ 4]  566 	add	a, a
    000002A0 87               [ 4]  567 	add	a, a
    000002A1 C6 70            [ 7]  568 	add	a, #0x70
    000002A3 DD 77 FF         [19]  569 	ld	-1 (ix), a
                                    570 ;../../../include/sms/sms.h:856: shadow_OAM[nb] = (y < VDP_SAT_TERM) ? y : 0xC0;
    000002A6 21r00r00         [10]  571 	ld	hl, #_shadow_OAM
    000002A9 06 00            [ 7]  572 	ld	b, #0x00
    000002AB 09               [11]  573 	add	hl, bc
    000002AC 36 8B            [10]  574 	ld	(hl), #0x8b
                                    575 ;../../../include/sms/sms.h:857: shadow_OAM[0x40+(nb << 1)] = x;
    000002AE 21r00r00         [10]  576 	ld	hl, #_shadow_OAM+0
    000002B1 7B               [ 4]  577 	ld	a, e
    000002B2 C6 40            [ 7]  578 	add	a, #0x40
    000002B4 5F               [ 4]  579 	ld	e, a
    000002B5 30 01            [12]  580 	jr	NC, 00127$
    000002B7 14               [ 4]  581 	inc	d
    000002B8                        582 00127$:
    000002B8 19               [11]  583 	add	hl, de
    000002B9 DD 7E FF         [19]  584 	ld	a, -1 (ix)
    000002BC 77               [ 7]  585 	ld	(hl), a
                                    586 ;src/joytest.c:36: for (uint8_t i = 0; i < 4; i++) {
    000002BD 0C               [ 4]  587 	inc	c
    000002BE 18 C5            [12]  588 	jr	00105$
    000002C0                        589 00107$:
                                    590 ;src/joytest.c:43: }
    000002C0 33               [ 6]  591 	inc	sp
    000002C1 DD E1            [14]  592 	pop	ix
    000002C3 C9               [10]  593 	ret
                                    594 ;src/joytest.c:51: void main(void) {
                                    595 ;	---------------------------------
                                    596 ; Function main
                                    597 ; ---------------------------------
    000002C4                        598 _main::
    000002C4 DD E5            [15]  599 	push	ix
    000002C6 DD 21 00 00      [14]  600 	ld	ix,#0
    000002CA DD 39            [15]  601 	add	ix,sp
    000002CC 21 FB FF         [10]  602 	ld	hl, #-5
    000002CF 39               [11]  603 	add	hl, sp
    000002D0 F9               [ 6]  604 	ld	sp, hl
                                    605 ;src/joytest.c:54: for (uint8_t i = 4; i != 0; i--) vsync();
    000002D1 0E 04            [ 7]  606 	ld	c, #0x04
    000002D3                        607 00141$:
    000002D3 79               [ 4]  608 	ld	a, c
    000002D4 B7               [ 4]  609 	or	a, a
    000002D5 28 06            [12]  610 	jr	Z, 00101$
    000002D7 CDr00r00         [17]  611 	call	_vsync
    000002DA 0D               [ 4]  612 	dec	c
    000002DB 18 F6            [12]  613 	jr	00141$
    000002DD                        614 00101$:
                                    615 ;src/joytest.c:60: joypad_init(4, &joypads);
    000002DD 21r05r00         [10]  616 	ld	hl, #_joypads
    000002E0 E5               [11]  617 	push	hl
    000002E1 3E 04            [ 7]  618 	ld	a, #0x04
    000002E3 F5               [11]  619 	push	af
    000002E4 33               [ 6]  620 	inc	sp
    000002E5 CDr00r00         [17]  621 	call	_joypad_init
                                    622 ;src/joytest.c:62: set_sprite_data(0, sizeof(sprite_data) >> 4, sprite_data);
                                    623 ;../../../include/sms/sms.h:644: set_tile_2bpp_data((uint8_t)(start) + 0x100u, ntiles, src, _current_2bpp_palette);
    000002E8 2Ar00r00         [16]  624 	ld	hl, (__current_2bpp_palette)
    000002EB E5               [11]  625 	push	hl
    000002EC 21r00r00         [10]  626 	ld	hl, #_sprite_data
    000002EF E5               [11]  627 	push	hl
    000002F0 21 04 00         [10]  628 	ld	hl, #0x0004
    000002F3 E5               [11]  629 	push	hl
    000002F4 21 00 01         [10]  630 	ld	hl, #0x0100
    000002F7 E5               [11]  631 	push	hl
    000002F8 CDr00r00         [17]  632 	call	_set_tile_2bpp_data
                                    633 ;src/joytest.c:63: set_bkg_data(1, sizeof(tiles_data) >> 4, tiles_data);
                                    634 ;../../../include/sms/sms.h:641: set_tile_2bpp_data(start, ntiles, src, _current_2bpp_palette);
    000002FB 2Ar00r00         [16]  635 	ld	hl, (__current_2bpp_palette)
    000002FE E5               [11]  636 	push	hl
    000002FF 21r00r00         [10]  637 	ld	hl, #_tiles_data
    00000302 E5               [11]  638 	push	hl
    00000303 21 5D 00         [10]  639 	ld	hl, #0x005d
    00000306 E5               [11]  640 	push	hl
    00000307 2E 01            [ 7]  641 	ld	l, #0x01
    00000309 E5               [11]  642 	push	hl
    0000030A CDr00r00         [17]  643 	call	_set_tile_2bpp_data
                                    644 ;src/joytest.c:64: fill_bkg_rect(0, 0, DEVICE_SCREEN_WIDTH, DEVICE_SCREEN_HEIGHT, 0);
    0000030D 21 00 00         [10]  645 	ld	hl, #0x0000
    00000310 E5               [11]  646 	push	hl
    00000311 21 20 18         [10]  647 	ld	hl, #0x1820
    00000314 E5               [11]  648 	push	hl
    00000315 21 00 00         [10]  649 	ld	hl, #0x00
    00000318 E5               [11]  650 	push	hl
    00000319 CDr00r00         [17]  651 	call	_fill_rect_compat
                                    652 ;src/joytest.c:66: if (isSGB) draw_disabled(0, 0); else draw_buttons(joy, 0, 0);
    0000031C 21r01r00         [10]  653 	ld	hl, #_isSGB
    0000031F CB 46            [12]  654 	bit	0, (hl)
    00000321 28 07            [12]  655 	jr	Z, 00103$
    00000323 AF               [ 4]  656 	xor	a, a
    00000324 6F               [ 4]  657 	ld	l, a
    00000325 CDr8Er01         [17]  658 	call	_draw_disabled
    00000328 18 0B            [12]  659 	jr	00164$
    0000032A                        660 00103$:
    0000032A AF               [ 4]  661 	xor	a, a
    0000032B F5               [11]  662 	push	af
    0000032C 33               [ 6]  663 	inc	sp
    0000032D 2E 00            [ 7]  664 	ld	l, #0x00
    0000032F 3Ar03r00         [13]  665 	ld	a, (_joy)
    00000332 CDr00r00         [17]  666 	call	_draw_buttons
                                    667 ;src/joytest.c:68: for (uint8_t i = 0; i != 4; i++) {
    00000335                        668 00164$:
    00000335 DD 36 FF 00      [19]  669 	ld	-1 (ix), #0x00
    00000339                        670 00144$:
    00000339 DD 7E FF         [19]  671 	ld	a, -1 (ix)
    0000033C D6 04            [ 7]  672 	sub	a, #0x04
    0000033E 28 3C            [12]  673 	jr	Z, 00108$
                                    674 ;src/joytest.c:69: if (i <= (joypads.npads - 1)) {
    00000340 21r05r00         [10]  675 	ld	hl, #_joypads
    00000343 5E               [ 7]  676 	ld	e, (hl)
    00000344 16 00            [ 7]  677 	ld	d, #0x00
    00000346 1B               [ 6]  678 	dec	de
    00000347 DD 6E FF         [19]  679 	ld	l, -1 (ix)
    0000034A 26 00            [ 7]  680 	ld	h, #0x00
                                    681 ;src/joytest.c:70: draw_buttons(joypads.joypads[i], 0, 4 + (i << 1)); 
    0000034C DD 7E FF         [19]  682 	ld	a, -1 (ix)
    0000034F 87               [ 4]  683 	add	a, a
    00000350 C6 04            [ 7]  684 	add	a, #0x04
    00000352 47               [ 4]  685 	ld	b, a
                                    686 ;src/joytest.c:69: if (i <= (joypads.npads - 1)) {
    00000353 7B               [ 4]  687 	ld	a, e
    00000354 95               [ 4]  688 	sub	a, l
    00000355 7A               [ 4]  689 	ld	a, d
    00000356 9C               [ 4]  690 	sbc	a, h
    00000357 E2r5Cr03         [10]  691 	jp	PO, 00324$
    0000035A EE 80            [ 7]  692 	xor	a, #0x80
    0000035C                        693 00324$:
    0000035C FAr72r03         [10]  694 	jp	M, 00106$
                                    695 ;src/joytest.c:70: draw_buttons(joypads.joypads[i], 0, 4 + (i << 1)); 
    0000035F DD 6E FF         [19]  696 	ld	l, -1 (ix)
    00000362 26 00            [ 7]  697 	ld	h, #0x00
    00000364 11r06r00         [10]  698 	ld	de, #(_joypads + 1)
    00000367 19               [11]  699 	add	hl, de
    00000368 7E               [ 7]  700 	ld	a, (hl)
    00000369 C5               [11]  701 	push	bc
    0000036A 33               [ 6]  702 	inc	sp
    0000036B 2E 00            [ 7]  703 	ld	l, #0x00
    0000036D CDr00r00         [17]  704 	call	_draw_buttons
    00000370 18 05            [12]  705 	jr	00145$
    00000372                        706 00106$:
                                    707 ;src/joytest.c:72: draw_disabled(0, 4 + (i << 1));
    00000372 68               [ 4]  708 	ld	l, b
    00000373 AF               [ 4]  709 	xor	a, a
    00000374 CDr8Er01         [17]  710 	call	_draw_disabled
    00000377                        711 00145$:
                                    712 ;src/joytest.c:68: for (uint8_t i = 0; i != 4; i++) {
    00000377 DD 34 FF         [23]  713 	inc	-1 (ix)
    0000037A 18 BD            [12]  714 	jr	00144$
    0000037C                        715 00108$:
                                    716 ;src/joytest.c:76: reset_object_pos();
    0000037C CDr7Ar02         [17]  717 	call	_reset_object_pos
                                    718 ;src/joytest.c:77: SHOW_SPRITES; SHOW_BKG;
    0000037F AF               [ 4]  719 	xor	a, a
    00000380 32r00r00         [13]  720 	ld	(__sprites_OFF+0), a
                                    721 ;src/joytest.c:79: while(TRUE) {
    00000383                        722 00132$:
                                    723 ;src/joytest.c:81: if (toggle = !toggle) {
    00000383 3Ar00r00         [13]  724 	ld	a, (_toggle+0)
    00000386 EE 01            [ 7]  725 	xor	a, #0x01
    00000388 4F               [ 4]  726 	ld	c, a
    00000389 32r00r00         [13]  727 	ld	(_toggle+0), a
    0000038C CB 41            [ 8]  728 	bit	0, c
    0000038E 28 37            [12]  729 	jr	Z, 00129$
                                    730 ;src/joytest.c:83: if (!isSGB) {
    00000390 21r01r00         [10]  731 	ld	hl, #_isSGB
    00000393 CB 46            [12]  732 	bit	0, (hl)
    00000395 C2r23r05         [10]  733 	jp	NZ, 00130$
                                    734 ;src/joytest.c:84: old_joy = joy, joy = joypad();
    00000398 3Ar03r00         [13]  735 	ld	a, (_joy+0)
    0000039B 32r02r00         [13]  736 	ld	(_old_joy+0), a
    0000039E CDr00r00         [17]  737 	call	_joypad
    000003A1 7D               [ 4]  738 	ld	a, l
    000003A2 32r03r00         [13]  739 	ld	(_joy+0), a
                                    740 ;src/joytest.c:87: if (joy != old_joy) draw_buttons(joy, 0, 0);
    000003A5 3Ar03r00         [13]  741 	ld	a, (_joy+0)
    000003A8 21r02r00         [10]  742 	ld	hl, #_old_joy
    000003AB 96               [ 7]  743 	sub	a, (hl)
    000003AC 28 0B            [12]  744 	jr	Z, 00110$
    000003AE AF               [ 4]  745 	xor	a, a
    000003AF F5               [11]  746 	push	af
    000003B0 33               [ 6]  747 	inc	sp
    000003B1 2E 00            [ 7]  748 	ld	l, #0x00
    000003B3 3Ar03r00         [13]  749 	ld	a, (_joy)
    000003B6 CDr00r00         [17]  750 	call	_draw_buttons
    000003B9                        751 00110$:
                                    752 ;src/joytest.c:90: if (joy & J_START) reset_object_pos();
    000003B9 3Ar03r00         [13]  753 	ld	a, (_joy)
    000003BC CB 77            [ 8]  754 	bit	6, a
    000003BE CAr23r05         [10]  755 	jp	Z, 00130$
    000003C1 CDr7Ar02         [17]  756 	call	_reset_object_pos
    000003C4 C3r23r05         [10]  757 	jp	00130$
    000003C7                        758 00129$:
                                    759 ;src/joytest.c:93: old_joypads = joypads;
    000003C7 11r00r00         [10]  760 	ld	de, #_old_joypads
    000003CA 21r05r00         [10]  761 	ld	hl, #_joypads
    000003CD 01 05 00         [10]  762 	ld	bc, #0x0005
    000003D0 ED B0            [21]  763 	ldir
                                    764 ;src/joytest.c:94: joypad_ex(&joypads);
    000003D2 21r05r00         [10]  765 	ld	hl, #_joypads
    000003D5 CDr00r00         [17]  766 	call	_joypad_ex
                                    767 ;src/joytest.c:96: for (uint8_t i = 0; i < joypads.npads; i++) {
    000003D8 DD 36 FF 00      [19]  768 	ld	-1 (ix), #0x00
    000003DC                        769 00147$:
    000003DC 21r05r00         [10]  770 	ld	hl, #_joypads
    000003DF DD 7E FF         [19]  771 	ld	a,-1 (ix)
    000003E2 96               [ 7]  772 	sub	a,(hl)
    000003E3 D2r23r05         [10]  773 	jp	NC, 00130$
                                    774 ;src/joytest.c:97: uint8_t j = joypads.joypads[i];
    000003E6 3Er06            [ 7]  775 	ld	a, #<((_joypads + 1))
    000003E8 DD 86 FF         [19]  776 	add	a, -1 (ix)
    000003EB 6F               [ 4]  777 	ld	l, a
    000003EC 3Es00            [ 7]  778 	ld	a, #>((_joypads + 1))
    000003EE CE 00            [ 7]  779 	adc	a, #0x00
    000003F0 67               [ 4]  780 	ld	h, a
    000003F1 7E               [ 7]  781 	ld	a, (hl)
    000003F2 DD 77 FB         [19]  782 	ld	-5 (ix), a
                                    783 ;src/joytest.c:100: if (old_joypads.joypads[i] != j) draw_buttons(j, 0, 4 + (i << 1));
    000003F5 3Er01            [ 7]  784 	ld	a, #<((_old_joypads + 1))
    000003F7 DD 86 FF         [19]  785 	add	a, -1 (ix)
    000003FA 6F               [ 4]  786 	ld	l, a
    000003FB 3Es00            [ 7]  787 	ld	a, #>((_old_joypads + 1))
    000003FD CE 00            [ 7]  788 	adc	a, #0x00
    000003FF 67               [ 4]  789 	ld	h, a
    00000400 7E               [ 7]  790 	ld	a, (hl)
    00000401 DD 96 FB         [19]  791 	sub	a, -5 (ix)
    00000404 28 10            [12]  792 	jr	Z, 00116$
    00000406 DD 7E FF         [19]  793 	ld	a, -1 (ix)
    00000409 87               [ 4]  794 	add	a, a
    0000040A C6 04            [ 7]  795 	add	a, #0x04
    0000040C F5               [11]  796 	push	af
    0000040D 33               [ 6]  797 	inc	sp
    0000040E 2E 00            [ 7]  798 	ld	l, #0x00
    00000410 DD 7E FB         [19]  799 	ld	a, -5 (ix)
    00000413 CDr00r00         [17]  800 	call	_draw_buttons
    00000416                        801 00116$:
                                    802 ;src/joytest.c:103: if (j & J_LEFT)  scroll_sprite(i, -1, 0);
    00000416 DD CB FB 56      [20]  803 	bit	2, -5 (ix)
    0000041A 28 43            [12]  804 	jr	Z, 00118$
    0000041C DD 7E FF         [19]  805 	ld	a, -1 (ix)
    0000041F DD 77 FC         [19]  806 	ld	-4 (ix), a
                                    807 ;../../../include/sms/sms.h:872: uint8_t new_y = shadow_OAM[nb] + y;
    00000422 01r00r00         [10]  808 	ld	bc, #_shadow_OAM+0
    00000425 DD 6E FF         [19]  809 	ld	l, -1 (ix)
    00000428 26 00            [ 7]  810 	ld	h, #0x00
    0000042A 09               [11]  811 	add	hl, bc
    0000042B 4E               [ 7]  812 	ld	c, (hl)
                                    813 ;../../../include/sms/sms.h:873: shadow_OAM[nb] = (new_y < VDP_SAT_TERM) ? new_y : 0xC0;
    0000042C DD 7E FF         [19]  814 	ld	a, -1 (ix)
    0000042F C6r00            [ 7]  815 	add	a, #<(_shadow_OAM)
    00000431 DD 77 FD         [19]  816 	ld	-3 (ix), a
    00000434 3E 00            [ 7]  817 	ld	a, #0x00
    00000436 CEs00            [ 7]  818 	adc	a, #>(_shadow_OAM)
    00000438 DD 77 FE         [19]  819 	ld	-2 (ix), a
    0000043B 79               [ 4]  820 	ld	a, c
    0000043C D6 D0            [ 7]  821 	sub	a, #0xd0
    0000043E 38 02            [12]  822 	jr	C, 00152$
    00000440 0E C0            [ 7]  823 	ld	c, #0xc0
    00000442                        824 00152$:
    00000442 D1               [10]  825 	pop	de
    00000443 E1               [10]  826 	pop	hl
    00000444 E5               [11]  827 	push	hl
    00000445 D5               [11]  828 	push	de
    00000446 71               [ 7]  829 	ld	(hl), c
                                    830 ;../../../include/sms/sms.h:874: shadow_OAM[0x40+(nb << 1)] += x;
    00000447 DD 6E FC         [19]  831 	ld	l, -4 (ix)
    0000044A 26 00            [ 7]  832 	ld	h, #0x00
    0000044C 29               [11]  833 	add	hl, hl
    0000044D 01 40 00         [10]  834 	ld	bc, #0x40
    00000450 09               [11]  835 	add	hl,bc
    00000451 4D               [ 4]  836 	ld	c, l
    00000452 44               [ 4]  837 	ld	b, h
    00000453 21r00r00         [10]  838 	ld	hl, #_shadow_OAM
    00000456 09               [11]  839 	add	hl, bc
    00000457 EB               [ 4]  840 	ex	de, hl
    00000458 21r00r00         [10]  841 	ld	hl, #_shadow_OAM+0
    0000045B 09               [11]  842 	add	hl, bc
    0000045C 7E               [ 7]  843 	ld	a, (hl)
    0000045D 3D               [ 4]  844 	dec	a
    0000045E 12               [ 7]  845 	ld	(de), a
                                    846 ;src/joytest.c:103: if (j & J_LEFT)  scroll_sprite(i, -1, 0);
    0000045F                        847 00118$:
                                    848 ;src/joytest.c:104: if (j & J_RIGHT) scroll_sprite(i, 1, 0);
    0000045F DD CB FB 5E      [20]  849 	bit	3, -5 (ix)
    00000463 28 36            [12]  850 	jr	Z, 00120$
    00000465 DD 4E FF         [19]  851 	ld	c, -1 (ix)
                                    852 ;../../../include/sms/sms.h:872: uint8_t new_y = shadow_OAM[nb] + y;
    00000468 11r00r00         [10]  853 	ld	de, #_shadow_OAM+0
    0000046B DD 6E FF         [19]  854 	ld	l, -1 (ix)
    0000046E 26 00            [ 7]  855 	ld	h, #0x00
    00000470 19               [11]  856 	add	hl, de
    00000471 46               [ 7]  857 	ld	b, (hl)
                                    858 ;../../../include/sms/sms.h:873: shadow_OAM[nb] = (new_y < VDP_SAT_TERM) ? new_y : 0xC0;
    00000472 11r00r00         [10]  859 	ld	de, #_shadow_OAM+0
    00000475 DD 6E FF         [19]  860 	ld	l, -1 (ix)
    00000478 26 00            [ 7]  861 	ld	h, #0x00
    0000047A 19               [11]  862 	add	hl, de
    0000047B 78               [ 4]  863 	ld	a, b
    0000047C D6 D0            [ 7]  864 	sub	a, #0xd0
    0000047E 38 02            [12]  865 	jr	C, 00154$
    00000480 06 C0            [ 7]  866 	ld	b, #0xc0
    00000482                        867 00154$:
    00000482 70               [ 7]  868 	ld	(hl), b
                                    869 ;../../../include/sms/sms.h:874: shadow_OAM[0x40+(nb << 1)] += x;
    00000483 06 00            [ 7]  870 	ld	b, #0x00
    00000485 79               [ 4]  871 	ld	a, c
    00000486 87               [ 4]  872 	add	a, a
    00000487 CB 10            [ 8]  873 	rl	b
    00000489 C6 40            [ 7]  874 	add	a, #0x40
    0000048B 4F               [ 4]  875 	ld	c, a
    0000048C 30 01            [12]  876 	jr	NC, 00331$
    0000048E 04               [ 4]  877 	inc	b
    0000048F                        878 00331$:
    0000048F 21r00r00         [10]  879 	ld	hl, #_shadow_OAM
    00000492 09               [11]  880 	add	hl, bc
    00000493 EB               [ 4]  881 	ex	de, hl
    00000494 21r00r00         [10]  882 	ld	hl, #_shadow_OAM+0
    00000497 09               [11]  883 	add	hl, bc
    00000498 7E               [ 7]  884 	ld	a, (hl)
    00000499 3C               [ 4]  885 	inc	a
    0000049A 12               [ 7]  886 	ld	(de), a
                                    887 ;src/joytest.c:104: if (j & J_RIGHT) scroll_sprite(i, 1, 0);
    0000049B                        888 00120$:
                                    889 ;src/joytest.c:105: if (j & J_UP)    scroll_sprite(i, 0, -1);
    0000049B DD CB FB 46      [20]  890 	bit	0, -5 (ix)
    0000049F 28 37            [12]  891 	jr	Z, 00122$
    000004A1 DD 4E FF         [19]  892 	ld	c, -1 (ix)
                                    893 ;../../../include/sms/sms.h:872: uint8_t new_y = shadow_OAM[nb] + y;
    000004A4 11r00r00         [10]  894 	ld	de, #_shadow_OAM+0
    000004A7 DD 6E FF         [19]  895 	ld	l, -1 (ix)
    000004AA 26 00            [ 7]  896 	ld	h, #0x00
    000004AC 19               [11]  897 	add	hl, de
    000004AD 7E               [ 7]  898 	ld	a, (hl)
    000004AE 3D               [ 4]  899 	dec	a
    000004AF 47               [ 4]  900 	ld	b, a
                                    901 ;../../../include/sms/sms.h:873: shadow_OAM[nb] = (new_y < VDP_SAT_TERM) ? new_y : 0xC0;
    000004B0 11r00r00         [10]  902 	ld	de, #_shadow_OAM+0
    000004B3 DD 6E FF         [19]  903 	ld	l, -1 (ix)
    000004B6 26 00            [ 7]  904 	ld	h, #0x00
    000004B8 19               [11]  905 	add	hl, de
    000004B9 78               [ 4]  906 	ld	a, b
    000004BA D6 D0            [ 7]  907 	sub	a, #0xd0
    000004BC 38 02            [12]  908 	jr	C, 00156$
    000004BE 06 C0            [ 7]  909 	ld	b, #0xc0
    000004C0                        910 00156$:
    000004C0 70               [ 7]  911 	ld	(hl), b
                                    912 ;../../../include/sms/sms.h:874: shadow_OAM[0x40+(nb << 1)] += x;
    000004C1 06 00            [ 7]  913 	ld	b, #0x00
    000004C3 79               [ 4]  914 	ld	a, c
    000004C4 87               [ 4]  915 	add	a, a
    000004C5 CB 10            [ 8]  916 	rl	b
    000004C7 C6 40            [ 7]  917 	add	a, #0x40
    000004C9 4F               [ 4]  918 	ld	c, a
    000004CA 30 01            [12]  919 	jr	NC, 00334$
    000004CC 04               [ 4]  920 	inc	b
    000004CD                        921 00334$:
    000004CD 21r00r00         [10]  922 	ld	hl, #_shadow_OAM
    000004D0 09               [11]  923 	add	hl, bc
    000004D1 EB               [ 4]  924 	ex	de, hl
    000004D2 21r00r00         [10]  925 	ld	hl, #_shadow_OAM+0
    000004D5 09               [11]  926 	add	hl, bc
    000004D6 7E               [ 7]  927 	ld	a, (hl)
    000004D7 12               [ 7]  928 	ld	(de), a
                                    929 ;src/joytest.c:105: if (j & J_UP)    scroll_sprite(i, 0, -1);
    000004D8                        930 00122$:
                                    931 ;src/joytest.c:106: if (j & J_DOWN)  scroll_sprite(i, 0, 1);
    000004D8 DD CB FB 4E      [20]  932 	bit	1, -5 (ix)
    000004DC 28 36            [12]  933 	jr	Z, 00124$
    000004DE DD 4E FF         [19]  934 	ld	c, -1 (ix)
                                    935 ;../../../include/sms/sms.h:872: uint8_t new_y = shadow_OAM[nb] + y;
    000004E1 11r00r00         [10]  936 	ld	de, #_shadow_OAM+0
    000004E4 DD 6E FF         [19]  937 	ld	l, -1 (ix)
    000004E7 26 00            [ 7]  938 	ld	h, #0x00
    000004E9 19               [11]  939 	add	hl, de
    000004EA 46               [ 7]  940 	ld	b, (hl)
    000004EB 04               [ 4]  941 	inc	b
                                    942 ;../../../include/sms/sms.h:873: shadow_OAM[nb] = (new_y < VDP_SAT_TERM) ? new_y : 0xC0;
    000004EC 11r00r00         [10]  943 	ld	de, #_shadow_OAM+0
    000004EF DD 6E FF         [19]  944 	ld	l, -1 (ix)
    000004F2 26 00            [ 7]  945 	ld	h, #0x00
    000004F4 19               [11]  946 	add	hl, de
    000004F5 78               [ 4]  947 	ld	a, b
    000004F6 D6 D0            [ 7]  948 	sub	a, #0xd0
    000004F8 38 02            [12]  949 	jr	C, 00158$
    000004FA 06 C0            [ 7]  950 	ld	b, #0xc0
    000004FC                        951 00158$:
    000004FC 70               [ 7]  952 	ld	(hl), b
                                    953 ;../../../include/sms/sms.h:874: shadow_OAM[0x40+(nb << 1)] += x;
    000004FD 79               [ 4]  954 	ld	a, c
    000004FE 06 00            [ 7]  955 	ld	b, #0x00
    00000500 87               [ 4]  956 	add	a, a
    00000501 CB 10            [ 8]  957 	rl	b
    00000503 C6 40            [ 7]  958 	add	a, #0x40
    00000505 4F               [ 4]  959 	ld	c, a
    00000506 30 01            [12]  960 	jr	NC, 00337$
    00000508 04               [ 4]  961 	inc	b
    00000509                        962 00337$:
    00000509 21r00r00         [10]  963 	ld	hl, #_shadow_OAM
    0000050C 09               [11]  964 	add	hl, bc
    0000050D EB               [ 4]  965 	ex	de, hl
    0000050E 21r00r00         [10]  966 	ld	hl, #_shadow_OAM
    00000511 09               [11]  967 	add	hl, bc
    00000512 7E               [ 7]  968 	ld	a, (hl)
    00000513 12               [ 7]  969 	ld	(de), a
                                    970 ;src/joytest.c:106: if (j & J_DOWN)  scroll_sprite(i, 0, 1);
    00000514                        971 00124$:
                                    972 ;src/joytest.c:109: if (j & J_START) reset_object_pos();
    00000514 DD CB FB 76      [20]  973 	bit	6, -5 (ix)
    00000518 28 03            [12]  974 	jr	Z, 00148$
    0000051A CDr7Ar02         [17]  975 	call	_reset_object_pos
    0000051D                        976 00148$:
                                    977 ;src/joytest.c:96: for (uint8_t i = 0; i < joypads.npads; i++) {
    0000051D DD 34 FF         [23]  978 	inc	-1 (ix)
    00000520 C3rDCr03         [10]  979 	jp	00147$
    00000523                        980 00130$:
                                    981 ;src/joytest.c:113: vsync();
    00000523 CDr00r00         [17]  982 	call	_vsync
                                    983 ;src/joytest.c:115: }
    00000526 C3r83r03         [10]  984 	jp	00132$
                                    985 	.area _CODE
                                    986 	.area _INITIALIZER
    00000000                        987 __xinit__toggle:
    00000000 00                     988 	.db #0x00	;  0
    00000001                        989 __xinit__isSGB:
    00000001 00                     990 	.db #0x00	;  0
    00000002                        991 __xinit__old_joy:
    00000002 FF                     992 	.db #0xff	; 255
    00000003                        993 __xinit__joy:
    00000003 00                     994 	.db #0x00	; 0
                                    995 	.area _CABS (ABS)
