                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Mac OS X ppc)
                                      4 ;--------------------------------------------------------
                                      5 	.module metasprites
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _load_and_duplicate_sprite_tile_data
                                     12 	.globl _get_tile_offset
                                     13 	.globl _set_tile
                                     14 	.globl _hide_sprites_range
                                     15 	.globl _fill_rect_compat
                                     16 	.globl _set_tile_2bpp_data
                                     17 	.globl _joypad
                                     18 	.globl _vsync
                                     19 	.globl _old_joyp
                                     20 	.globl _joyp
                                     21 	.globl _num_tiles
                                     22 	.globl _flipped_data
                                     23 	.globl _rot
                                     24 	.globl _idx
                                     25 	.globl _PosF
                                     26 	.globl _SpdY
                                     27 	.globl _SpdX
                                     28 	.globl _PosY
                                     29 	.globl _PosX
                                     30 	.globl _green_pal
                                     31 	.globl _cyan_pal
                                     32 	.globl _pink_pal
                                     33 	.globl _gray_pal
                                     34 	.globl _reverse_bits
                                     35 	.globl _pattern
                                     36 ;--------------------------------------------------------
                                     37 ; special function registers
                                     38 ;--------------------------------------------------------
                         00000000    39 _GG_STATE	=	0x0000
                         00000001    40 _GG_EXT_7BIT	=	0x0001
                         00000002    41 _GG_EXT_CTL	=	0x0002
                         00000003    42 _GG_SIO_SEND	=	0x0003
                         00000004    43 _GG_SIO_RECV	=	0x0004
                         00000005    44 _GG_SIO_CTL	=	0x0005
                         00000006    45 _GG_SOUND_PAN	=	0x0006
                         0000003E    46 _MEMORY_CTL	=	0x003e
                         0000003F    47 _JOY_CTL	=	0x003f
                         0000007E    48 _VCOUNTER	=	0x007e
                         0000007F    49 _PSG	=	0x007f
                         0000007F    50 _HCOUNTER	=	0x007f
                         000000BE    51 _VDP_DATA	=	0x00be
                         000000BF    52 _VDP_CMD	=	0x00bf
                         000000BF    53 _VDP_STATUS	=	0x00bf
                         000000DC    54 _JOY_PORT1	=	0x00dc
                         000000DD    55 _JOY_PORT2	=	0x00dd
                         000000F0    56 _FMADDRESS	=	0x00f0
                         000000F1    57 _FMDATA	=	0x00f1
                         000000F2    58 _AUDIOCTRL	=	0x00f2
                                     59 ;--------------------------------------------------------
                                     60 ; ram data
                                     61 ;--------------------------------------------------------
                                     62 	.area _DATA
                         0000FFFC    63 _RAM_CONTROL	=	0xfffc
                         0000FFF8    64 _GLASSES_3D	=	0xfff8
                         0000FFFD    65 _MAP_FRAME0	=	0xfffd
                         0000FFFE    66 _MAP_FRAME1	=	0xfffe
                         0000FFFF    67 _MAP_FRAME2	=	0xffff
    00000000                         68 _PosX::
    00000000                         69 	.ds 2
    00000002                         70 _PosY::
    00000002                         71 	.ds 2
    00000004                         72 _SpdX::
    00000004                         73 	.ds 2
    00000006                         74 _SpdY::
    00000006                         75 	.ds 2
    00000008                         76 _PosF::
    00000008                         77 	.ds 1
    00000009                         78 _idx::
    00000009                         79 	.ds 1
    0000000A                         80 _rot::
    0000000A                         81 	.ds 1
    0000000B                         82 _flipped_data::
    0000000B                         83 	.ds 16
    0000001B                         84 _num_tiles::
    0000001B                         85 	.ds 2
                                     86 ;--------------------------------------------------------
                                     87 ; ram data
                                     88 ;--------------------------------------------------------
                                     89 	.area _INITIALIZED
    00000000                         90 _joyp::
    00000000                         91 	.ds 1
    00000001                         92 _old_joyp::
    00000001                         93 	.ds 1
                                     94 ;--------------------------------------------------------
                                     95 ; absolute external ram data
                                     96 ;--------------------------------------------------------
                                     97 	.area _DABS (ABS)
                                     98 ;--------------------------------------------------------
                                     99 ; global & static initialisations
                                    100 ;--------------------------------------------------------
                                    101 	.area _HOME
                                    102 	.area _GSINIT
                                    103 	.area _GSFINAL
                                    104 	.area _GSINIT
                                    105 ;--------------------------------------------------------
                                    106 ; Home
                                    107 ;--------------------------------------------------------
                                    108 	.area _HOME
                                    109 	.area _HOME
                                    110 ;--------------------------------------------------------
                                    111 ; code
                                    112 ;--------------------------------------------------------
                                    113 	.area _CODE
                                    114 ;src/metasprites.c:94: void set_tile(uint8_t tile_idx, uint8_t* data, uint8_t flip_x, uint8_t flip_y)
                                    115 ;	---------------------------------
                                    116 ; Function set_tile
                                    117 ; ---------------------------------
    00000000                        118 _set_tile::
    00000000 DD E5            [15]  119 	push	ix
    00000002 DD 21 00 00      [14]  120 	ld	ix,#0
    00000006 DD 39            [15]  121 	add	ix,sp
    00000008 21 F9 FF         [10]  122 	ld	hl, #-7
    0000000B 39               [11]  123 	add	hl, sp
    0000000C F9               [ 6]  124 	ld	sp, hl
    0000000D DD 77 FD         [19]  125 	ld	-3 (ix), a
    00000010 DD 73 FB         [19]  126 	ld	-5 (ix), e
    00000013 DD 72 FC         [19]  127 	ld	-4 (ix), d
                                    128 ;src/metasprites.c:97: for(i = 0; i < TILE_HEIGHT; i++)
    00000016 AF               [ 4]  129 	xor	a, a
    00000017 DD 77 FE         [19]  130 	ld	-2 (ix), a
    0000001A DD 77 FF         [19]  131 	ld	-1 (ix), a
    0000001D                        132 00103$:
                                    133 ;src/metasprites.c:99: size_t y = flip_y ? (TILE_HEIGHT-1-i) : i; 
    0000001D DD 7E 05         [19]  134 	ld	a, 5 (ix)
    00000020 B7               [ 4]  135 	or	a, a
    00000021 28 11            [12]  136 	jr	Z, 00107$
    00000023 3E 07            [ 7]  137 	ld	a, #0x07
    00000025 DD 96 FE         [19]  138 	sub	a, -2 (ix)
    00000028 DD 77 F9         [19]  139 	ld	-7 (ix), a
    0000002B 9F               [ 4]  140 	sbc	a, a
    0000002C DD 96 FF         [19]  141 	sub	a, -1 (ix)
    0000002F DD 77 FA         [19]  142 	ld	-6 (ix), a
    00000032 18 0A            [12]  143 	jr	00108$
    00000034                        144 00107$:
    00000034 DD 7E FE         [19]  145 	ld	a, -2 (ix)
    00000037 DD 77 F9         [19]  146 	ld	-7 (ix), a
    0000003A DD 36 FA 00      [19]  147 	ld	-6 (ix), #0x00
    0000003E                        148 00108$:
    0000003E D1               [10]  149 	pop	de
    0000003F D5               [11]  150 	push	de
                                    151 ;src/metasprites.c:100: flipped_data[2*i] = flip_x ? reverse_bits[data[2*y]] : data[2*y];
    00000040 DD 7E FE         [19]  152 	ld	a, -2 (ix)
    00000043 87               [ 4]  153 	add	a, a
    00000044 4F               [ 4]  154 	ld	c, a
    00000045 C6r0B            [ 7]  155 	add	a, #<(_flipped_data)
    00000047 DD 77 F9         [19]  156 	ld	-7 (ix), a
    0000004A 3E 00            [ 7]  157 	ld	a, #0x00
    0000004C CEs00            [ 7]  158 	adc	a, #>(_flipped_data)
    0000004E DD 77 FA         [19]  159 	ld	-6 (ix), a
    00000051 EB               [ 4]  160 	ex	de, hl
    00000052 29               [11]  161 	add	hl, hl
    00000053 EB               [ 4]  162 	ex	de, hl
    00000054 DD 6E FB         [19]  163 	ld	l, -5 (ix)
    00000057 DD 66 FC         [19]  164 	ld	h, -4 (ix)
    0000005A 19               [11]  165 	add	hl, de
    0000005B 46               [ 7]  166 	ld	b, (hl)
    0000005C DD 7E 04         [19]  167 	ld	a, 4 (ix)
    0000005F B7               [ 4]  168 	or	a, a
    00000060 28 0A            [12]  169 	jr	Z, 00109$
    00000062 3ErCB            [ 7]  170 	ld	a, #<(_reverse_bits)
    00000064 80               [ 4]  171 	add	a, b
    00000065 6F               [ 4]  172 	ld	l, a
    00000066 3Es00            [ 7]  173 	ld	a, #>(_reverse_bits)
    00000068 CE 00            [ 7]  174 	adc	a, #0x00
    0000006A 67               [ 4]  175 	ld	h, a
    0000006B 46               [ 7]  176 	ld	b, (hl)
    0000006C                        177 00109$:
    0000006C E1               [10]  178 	pop	hl
    0000006D E5               [11]  179 	push	hl
    0000006E 70               [ 7]  180 	ld	(hl), b
                                    181 ;src/metasprites.c:101: flipped_data[2*i+1] = flip_x ? reverse_bits[data[2*y+1]] : data[2*y+1];
    0000006F 79               [ 4]  182 	ld	a, c
    00000070 3C               [ 4]  183 	inc	a
    00000071 C6r0B            [ 7]  184 	add	a, #<(_flipped_data)
    00000073 4F               [ 4]  185 	ld	c, a
    00000074 3E 00            [ 7]  186 	ld	a, #0x00
    00000076 CEs00            [ 7]  187 	adc	a, #>(_flipped_data)
    00000078 47               [ 4]  188 	ld	b, a
    00000079 13               [ 6]  189 	inc	de
    0000007A DD 6E FB         [19]  190 	ld	l, -5 (ix)
    0000007D DD 66 FC         [19]  191 	ld	h, -4 (ix)
    00000080 19               [11]  192 	add	hl, de
    00000081 6E               [ 7]  193 	ld	l, (hl)
    00000082 DD 7E 04         [19]  194 	ld	a, 4 (ix)
    00000085 B7               [ 4]  195 	or	a, a
    00000086 28 09            [12]  196 	jr	Z, 00111$
    00000088 26 00            [ 7]  197 	ld	h, #0x00
    0000008A 11rCBr00         [10]  198 	ld	de, #_reverse_bits
    0000008D 19               [11]  199 	add	hl, de
    0000008E 7E               [ 7]  200 	ld	a, (hl)
    0000008F 18 01            [12]  201 	jr	00112$
    00000091                        202 00111$:
    00000091 7D               [ 4]  203 	ld	a, l
    00000092                        204 00112$:
    00000092 02               [ 7]  205 	ld	(bc), a
                                    206 ;src/metasprites.c:97: for(i = 0; i < TILE_HEIGHT; i++)
    00000093 DD 34 FE         [23]  207 	inc	-2 (ix)
    00000096 DD 7E FE         [19]  208 	ld	a, -2 (ix)
    00000099 D6 08            [ 7]  209 	sub	a, #0x08
    0000009B DAr1Dr00         [10]  210 	jp	C, 00103$
                                    211 ;src/metasprites.c:103: set_sprite_data(tile_idx, 1, flipped_data);
                                    212 ;../../../include/sms/sms.h:644: set_tile_2bpp_data((uint8_t)(start) + 0x100u, ntiles, src, _current_2bpp_palette);
    0000009E DD 4E FD         [19]  213 	ld	c, -3 (ix)
    000000A1 06 00            [ 7]  214 	ld	b, #0x00
    000000A3 04               [ 4]  215 	inc	b
    000000A4 2Ar00r00         [16]  216 	ld	hl, (__current_2bpp_palette)
    000000A7 E5               [11]  217 	push	hl
    000000A8 21r0Br00         [10]  218 	ld	hl, #_flipped_data
    000000AB E5               [11]  219 	push	hl
    000000AC 21 01 00         [10]  220 	ld	hl, #0x0001
    000000AF E5               [11]  221 	push	hl
    000000B0 C5               [11]  222 	push	bc
    000000B1 CDr00r00         [17]  223 	call	_set_tile_2bpp_data
                                    224 ;src/metasprites.c:103: set_sprite_data(tile_idx, 1, flipped_data);
                                    225 ;src/metasprites.c:104: }
    000000B4 DD F9            [10]  226 	ld	sp, ix
    000000B6 DD E1            [14]  227 	pop	ix
    000000B8 E1               [10]  228 	pop	hl
    000000B9 F1               [10]  229 	pop	af
    000000BA E9               [ 4]  230 	jp	(hl)
    000000BB                        231 _pattern:
    000000BB 80                     232 	.db #0x80	; 128
    000000BC 80                     233 	.db #0x80	; 128
    000000BD 40                     234 	.db #0x40	; 64
    000000BE 40                     235 	.db #0x40	; 64
    000000BF 20                     236 	.db #0x20	; 32
    000000C0 20                     237 	.db #0x20	; 32
    000000C1 10                     238 	.db #0x10	; 16
    000000C2 10                     239 	.db #0x10	; 16
    000000C3 08                     240 	.db #0x08	; 8
    000000C4 08                     241 	.db #0x08	; 8
    000000C5 04                     242 	.db #0x04	; 4
    000000C6 04                     243 	.db #0x04	; 4
    000000C7 02                     244 	.db #0x02	; 2
    000000C8 02                     245 	.db #0x02	; 2
    000000C9 01                     246 	.db #0x01	; 1
    000000CA 01                     247 	.db #0x01	; 1
    000000CB                        248 _reverse_bits:
    000000CB 00                     249 	.db #0x00	; 0
    000000CC 80                     250 	.db #0x80	; 128
    000000CD 40                     251 	.db #0x40	; 64
    000000CE C0                     252 	.db #0xc0	; 192
    000000CF 20                     253 	.db #0x20	; 32
    000000D0 A0                     254 	.db #0xa0	; 160
    000000D1 60                     255 	.db #0x60	; 96
    000000D2 E0                     256 	.db #0xe0	; 224
    000000D3 10                     257 	.db #0x10	; 16
    000000D4 90                     258 	.db #0x90	; 144
    000000D5 50                     259 	.db #0x50	; 80	'P'
    000000D6 D0                     260 	.db #0xd0	; 208
    000000D7 30                     261 	.db #0x30	; 48	'0'
    000000D8 B0                     262 	.db #0xb0	; 176
    000000D9 70                     263 	.db #0x70	; 112	'p'
    000000DA F0                     264 	.db #0xf0	; 240
    000000DB 08                     265 	.db #0x08	; 8
    000000DC 88                     266 	.db #0x88	; 136
    000000DD 48                     267 	.db #0x48	; 72	'H'
    000000DE C8                     268 	.db #0xc8	; 200
    000000DF 28                     269 	.db #0x28	; 40
    000000E0 A8                     270 	.db #0xa8	; 168
    000000E1 68                     271 	.db #0x68	; 104	'h'
    000000E2 E8                     272 	.db #0xe8	; 232
    000000E3 18                     273 	.db #0x18	; 24
    000000E4 98                     274 	.db #0x98	; 152
    000000E5 58                     275 	.db #0x58	; 88	'X'
    000000E6 D8                     276 	.db #0xd8	; 216
    000000E7 38                     277 	.db #0x38	; 56	'8'
    000000E8 B8                     278 	.db #0xb8	; 184
    000000E9 78                     279 	.db #0x78	; 120	'x'
    000000EA F8                     280 	.db #0xf8	; 248
    000000EB 04                     281 	.db #0x04	; 4
    000000EC 84                     282 	.db #0x84	; 132
    000000ED 44                     283 	.db #0x44	; 68	'D'
    000000EE C4                     284 	.db #0xc4	; 196
    000000EF 24                     285 	.db #0x24	; 36
    000000F0 A4                     286 	.db #0xa4	; 164
    000000F1 64                     287 	.db #0x64	; 100	'd'
    000000F2 E4                     288 	.db #0xe4	; 228
    000000F3 14                     289 	.db #0x14	; 20
    000000F4 94                     290 	.db #0x94	; 148
    000000F5 54                     291 	.db #0x54	; 84	'T'
    000000F6 D4                     292 	.db #0xd4	; 212
    000000F7 34                     293 	.db #0x34	; 52	'4'
    000000F8 B4                     294 	.db #0xb4	; 180
    000000F9 74                     295 	.db #0x74	; 116	't'
    000000FA F4                     296 	.db #0xf4	; 244
    000000FB 0C                     297 	.db #0x0c	; 12
    000000FC 8C                     298 	.db #0x8c	; 140
    000000FD 4C                     299 	.db #0x4c	; 76	'L'
    000000FE CC                     300 	.db #0xcc	; 204
    000000FF 2C                     301 	.db #0x2c	; 44
    00000100 AC                     302 	.db #0xac	; 172
    00000101 6C                     303 	.db #0x6c	; 108	'l'
    00000102 EC                     304 	.db #0xec	; 236
    00000103 1C                     305 	.db #0x1c	; 28
    00000104 9C                     306 	.db #0x9c	; 156
    00000105 5C                     307 	.db #0x5c	; 92
    00000106 DC                     308 	.db #0xdc	; 220
    00000107 3C                     309 	.db #0x3c	; 60
    00000108 BC                     310 	.db #0xbc	; 188
    00000109 7C                     311 	.db #0x7c	; 124
    0000010A FC                     312 	.db #0xfc	; 252
    0000010B 02                     313 	.db #0x02	; 2
    0000010C 82                     314 	.db #0x82	; 130
    0000010D 42                     315 	.db #0x42	; 66	'B'
    0000010E C2                     316 	.db #0xc2	; 194
    0000010F 22                     317 	.db #0x22	; 34
    00000110 A2                     318 	.db #0xa2	; 162
    00000111 62                     319 	.db #0x62	; 98	'b'
    00000112 E2                     320 	.db #0xe2	; 226
    00000113 12                     321 	.db #0x12	; 18
    00000114 92                     322 	.db #0x92	; 146
    00000115 52                     323 	.db #0x52	; 82	'R'
    00000116 D2                     324 	.db #0xd2	; 210
    00000117 32                     325 	.db #0x32	; 50	'2'
    00000118 B2                     326 	.db #0xb2	; 178
    00000119 72                     327 	.db #0x72	; 114	'r'
    0000011A F2                     328 	.db #0xf2	; 242
    0000011B 0A                     329 	.db #0x0a	; 10
    0000011C 8A                     330 	.db #0x8a	; 138
    0000011D 4A                     331 	.db #0x4a	; 74	'J'
    0000011E CA                     332 	.db #0xca	; 202
    0000011F 2A                     333 	.db #0x2a	; 42
    00000120 AA                     334 	.db #0xaa	; 170
    00000121 6A                     335 	.db #0x6a	; 106	'j'
    00000122 EA                     336 	.db #0xea	; 234
    00000123 1A                     337 	.db #0x1a	; 26
    00000124 9A                     338 	.db #0x9a	; 154
    00000125 5A                     339 	.db #0x5a	; 90	'Z'
    00000126 DA                     340 	.db #0xda	; 218
    00000127 3A                     341 	.db #0x3a	; 58
    00000128 BA                     342 	.db #0xba	; 186
    00000129 7A                     343 	.db #0x7a	; 122	'z'
    0000012A FA                     344 	.db #0xfa	; 250
    0000012B 06                     345 	.db #0x06	; 6
    0000012C 86                     346 	.db #0x86	; 134
    0000012D 46                     347 	.db #0x46	; 70	'F'
    0000012E C6                     348 	.db #0xc6	; 198
    0000012F 26                     349 	.db #0x26	; 38
    00000130 A6                     350 	.db #0xa6	; 166
    00000131 66                     351 	.db #0x66	; 102	'f'
    00000132 E6                     352 	.db #0xe6	; 230
    00000133 16                     353 	.db #0x16	; 22
    00000134 96                     354 	.db #0x96	; 150
    00000135 56                     355 	.db #0x56	; 86	'V'
    00000136 D6                     356 	.db #0xd6	; 214
    00000137 36                     357 	.db #0x36	; 54	'6'
    00000138 B6                     358 	.db #0xb6	; 182
    00000139 76                     359 	.db #0x76	; 118	'v'
    0000013A F6                     360 	.db #0xf6	; 246
    0000013B 0E                     361 	.db #0x0e	; 14
    0000013C 8E                     362 	.db #0x8e	; 142
    0000013D 4E                     363 	.db #0x4e	; 78	'N'
    0000013E CE                     364 	.db #0xce	; 206
    0000013F 2E                     365 	.db #0x2e	; 46
    00000140 AE                     366 	.db #0xae	; 174
    00000141 6E                     367 	.db #0x6e	; 110	'n'
    00000142 EE                     368 	.db #0xee	; 238
    00000143 1E                     369 	.db #0x1e	; 30
    00000144 9E                     370 	.db #0x9e	; 158
    00000145 5E                     371 	.db #0x5e	; 94
    00000146 DE                     372 	.db #0xde	; 222
    00000147 3E                     373 	.db #0x3e	; 62
    00000148 BE                     374 	.db #0xbe	; 190
    00000149 7E                     375 	.db #0x7e	; 126
    0000014A FE                     376 	.db #0xfe	; 254
    0000014B 01                     377 	.db #0x01	; 1
    0000014C 81                     378 	.db #0x81	; 129
    0000014D 41                     379 	.db #0x41	; 65	'A'
    0000014E C1                     380 	.db #0xc1	; 193
    0000014F 21                     381 	.db #0x21	; 33
    00000150 A1                     382 	.db #0xa1	; 161
    00000151 61                     383 	.db #0x61	; 97	'a'
    00000152 E1                     384 	.db #0xe1	; 225
    00000153 11                     385 	.db #0x11	; 17
    00000154 91                     386 	.db #0x91	; 145
    00000155 51                     387 	.db #0x51	; 81	'Q'
    00000156 D1                     388 	.db #0xd1	; 209
    00000157 31                     389 	.db #0x31	; 49	'1'
    00000158 B1                     390 	.db #0xb1	; 177
    00000159 71                     391 	.db #0x71	; 113	'q'
    0000015A F1                     392 	.db #0xf1	; 241
    0000015B 09                     393 	.db #0x09	; 9
    0000015C 89                     394 	.db #0x89	; 137
    0000015D 49                     395 	.db #0x49	; 73	'I'
    0000015E C9                     396 	.db #0xc9	; 201
    0000015F 29                     397 	.db #0x29	; 41
    00000160 A9                     398 	.db #0xa9	; 169
    00000161 69                     399 	.db #0x69	; 105	'i'
    00000162 E9                     400 	.db #0xe9	; 233
    00000163 19                     401 	.db #0x19	; 25
    00000164 99                     402 	.db #0x99	; 153
    00000165 59                     403 	.db #0x59	; 89	'Y'
    00000166 D9                     404 	.db #0xd9	; 217
    00000167 39                     405 	.db #0x39	; 57	'9'
    00000168 B9                     406 	.db #0xb9	; 185
    00000169 79                     407 	.db #0x79	; 121	'y'
    0000016A F9                     408 	.db #0xf9	; 249
    0000016B 05                     409 	.db #0x05	; 5
    0000016C 85                     410 	.db #0x85	; 133
    0000016D 45                     411 	.db #0x45	; 69	'E'
    0000016E C5                     412 	.db #0xc5	; 197
    0000016F 25                     413 	.db #0x25	; 37
    00000170 A5                     414 	.db #0xa5	; 165
    00000171 65                     415 	.db #0x65	; 101	'e'
    00000172 E5                     416 	.db #0xe5	; 229
    00000173 15                     417 	.db #0x15	; 21
    00000174 95                     418 	.db #0x95	; 149
    00000175 55                     419 	.db #0x55	; 85	'U'
    00000176 D5                     420 	.db #0xd5	; 213
    00000177 35                     421 	.db #0x35	; 53	'5'
    00000178 B5                     422 	.db #0xb5	; 181
    00000179 75                     423 	.db #0x75	; 117	'u'
    0000017A F5                     424 	.db #0xf5	; 245
    0000017B 0D                     425 	.db #0x0d	; 13
    0000017C 8D                     426 	.db #0x8d	; 141
    0000017D 4D                     427 	.db #0x4d	; 77	'M'
    0000017E CD                     428 	.db #0xcd	; 205
    0000017F 2D                     429 	.db #0x2d	; 45
    00000180 AD                     430 	.db #0xad	; 173
    00000181 6D                     431 	.db #0x6d	; 109	'm'
    00000182 ED                     432 	.db #0xed	; 237
    00000183 1D                     433 	.db #0x1d	; 29
    00000184 9D                     434 	.db #0x9d	; 157
    00000185 5D                     435 	.db #0x5d	; 93
    00000186 DD                     436 	.db #0xdd	; 221
    00000187 3D                     437 	.db #0x3d	; 61
    00000188 BD                     438 	.db #0xbd	; 189
    00000189 7D                     439 	.db #0x7d	; 125
    0000018A FD                     440 	.db #0xfd	; 253
    0000018B 03                     441 	.db #0x03	; 3
    0000018C 83                     442 	.db #0x83	; 131
    0000018D 43                     443 	.db #0x43	; 67	'C'
    0000018E C3                     444 	.db #0xc3	; 195
    0000018F 23                     445 	.db #0x23	; 35
    00000190 A3                     446 	.db #0xa3	; 163
    00000191 63                     447 	.db #0x63	; 99	'c'
    00000192 E3                     448 	.db #0xe3	; 227
    00000193 13                     449 	.db #0x13	; 19
    00000194 93                     450 	.db #0x93	; 147
    00000195 53                     451 	.db #0x53	; 83	'S'
    00000196 D3                     452 	.db #0xd3	; 211
    00000197 33                     453 	.db #0x33	; 51	'3'
    00000198 B3                     454 	.db #0xb3	; 179
    00000199 73                     455 	.db #0x73	; 115	's'
    0000019A F3                     456 	.db #0xf3	; 243
    0000019B 0B                     457 	.db #0x0b	; 11
    0000019C 8B                     458 	.db #0x8b	; 139
    0000019D 4B                     459 	.db #0x4b	; 75	'K'
    0000019E CB                     460 	.db #0xcb	; 203
    0000019F 2B                     461 	.db #0x2b	; 43
    000001A0 AB                     462 	.db #0xab	; 171
    000001A1 6B                     463 	.db #0x6b	; 107	'k'
    000001A2 EB                     464 	.db #0xeb	; 235
    000001A3 1B                     465 	.db #0x1b	; 27
    000001A4 9B                     466 	.db #0x9b	; 155
    000001A5 5B                     467 	.db #0x5b	; 91
    000001A6 DB                     468 	.db #0xdb	; 219
    000001A7 3B                     469 	.db #0x3b	; 59
    000001A8 BB                     470 	.db #0xbb	; 187
    000001A9 7B                     471 	.db #0x7b	; 123
    000001AA FB                     472 	.db #0xfb	; 251
    000001AB 07                     473 	.db #0x07	; 7
    000001AC 87                     474 	.db #0x87	; 135
    000001AD 47                     475 	.db #0x47	; 71	'G'
    000001AE C7                     476 	.db #0xc7	; 199
    000001AF 27                     477 	.db #0x27	; 39
    000001B0 A7                     478 	.db #0xa7	; 167
    000001B1 67                     479 	.db #0x67	; 103	'g'
    000001B2 E7                     480 	.db #0xe7	; 231
    000001B3 17                     481 	.db #0x17	; 23
    000001B4 97                     482 	.db #0x97	; 151
    000001B5 57                     483 	.db #0x57	; 87	'W'
    000001B6 D7                     484 	.db #0xd7	; 215
    000001B7 37                     485 	.db #0x37	; 55	'7'
    000001B8 B7                     486 	.db #0xb7	; 183
    000001B9 77                     487 	.db #0x77	; 119	'w'
    000001BA F7                     488 	.db #0xf7	; 247
    000001BB 0F                     489 	.db #0x0f	; 15
    000001BC 8F                     490 	.db #0x8f	; 143
    000001BD 4F                     491 	.db #0x4f	; 79	'O'
    000001BE CF                     492 	.db #0xcf	; 207
    000001BF 2F                     493 	.db #0x2f	; 47
    000001C0 AF                     494 	.db #0xaf	; 175
    000001C1 6F                     495 	.db #0x6f	; 111	'o'
    000001C2 EF                     496 	.db #0xef	; 239
    000001C3 1F                     497 	.db #0x1f	; 31
    000001C4 9F                     498 	.db #0x9f	; 159
    000001C5 5F                     499 	.db #0x5f	; 95
    000001C6 DF                     500 	.db #0xdf	; 223
    000001C7 3F                     501 	.db #0x3f	; 63
    000001C8 BF                     502 	.db #0xbf	; 191
    000001C9 7F                     503 	.db #0x7f	; 127
    000001CA FF                     504 	.db #0xff	; 255
                                    505 ;src/metasprites.c:106: uint8_t get_tile_offset(uint8_t flipx, uint8_t flipy)
                                    506 ;	---------------------------------
                                    507 ; Function get_tile_offset
                                    508 ; ---------------------------------
    000001CB                        509 _get_tile_offset::
    000001CB 4F               [ 4]  510 	ld	c, a
                                    511 ;src/metasprites.c:111: offset += flipy ? num_tiles : 0;
    000001CC 7D               [ 4]  512 	ld	a, l
    000001CD 2Ar1Br00         [16]  513 	ld	hl, (_num_tiles)
    000001D0 B7               [ 4]  514 	or	a, a
    000001D1 28 03            [12]  515 	jr	Z, 00103$
    000001D3 7D               [ 4]  516 	ld	a, l
    000001D4 18 01            [12]  517 	jr	00104$
    000001D6                        518 00103$:
    000001D6 AF               [ 4]  519 	xor	a, a
    000001D7                        520 00104$:
                                    521 ;src/metasprites.c:114: offset <<= 1;
    000001D7 87               [ 4]  522 	add	a, a
                                    523 ;src/metasprites.c:115: offset += flipx ? num_tiles : 0;
    000001D8 0C               [ 4]  524 	inc	c
    000001D9 0D               [ 4]  525 	dec	c
    000001DA 28 03            [12]  526 	jr	Z, 00105$
    000001DC 4D               [ 4]  527 	ld	c, l
    000001DD 18 03            [12]  528 	jr	00106$
    000001DF                        529 00105$:
    000001DF 01 00 00         [10]  530 	ld	bc, #0x0000
    000001E2                        531 00106$:
    000001E2 81               [ 4]  532 	add	a, c
                                    533 ;src/metasprites.c:117: return offset;
                                    534 ;src/metasprites.c:118: }
    000001E3 C9               [10]  535 	ret
                                    536 ;src/metasprites.c:123: void load_and_duplicate_sprite_tile_data(void)
                                    537 ;	---------------------------------
                                    538 ; Function load_and_duplicate_sprite_tile_data
                                    539 ; ---------------------------------
    000001E4                        540 _load_and_duplicate_sprite_tile_data::
    000001E4 DD E5            [15]  541 	push	ix
    000001E6 DD 21 00 00      [14]  542 	ld	ix,#0
    000001EA DD 39            [15]  543 	add	ix,sp
    000001EC 3B               [ 6]  544 	dec	sp
                                    545 ;src/metasprites.c:126: num_tiles = sizeof(sprite_tiles) >> 4;
    000001ED 21 30 00         [10]  546 	ld	hl, #0x0030
    000001F0 22r1Br00         [16]  547 	ld	(_num_tiles), hl
                                    548 ;src/metasprites.c:127: for(i = 0; i < num_tiles; i++)
    000001F3 01 00 00         [10]  549 	ld	bc, #0x0000
    000001F6                        550 00103$:
    000001F6 21r1Br00         [10]  551 	ld	hl, #_num_tiles
    000001F9 79               [ 4]  552 	ld	a, c
    000001FA 96               [ 7]  553 	sub	a, (hl)
    000001FB 23               [ 6]  554 	inc	hl
    000001FC 78               [ 4]  555 	ld	a, b
    000001FD 9E               [ 7]  556 	sbc	a, (hl)
    000001FE 30 73            [12]  557 	jr	NC, 00105$
                                    558 ;src/metasprites.c:129: set_tile(i + get_tile_offset(0, 0), sprite_tiles + (i << 4), 0, 0);
    00000200 69               [ 4]  559 	ld	l, c
    00000201 60               [ 4]  560 	ld	h, b
    00000202 29               [11]  561 	add	hl, hl
    00000203 29               [11]  562 	add	hl, hl
    00000204 29               [11]  563 	add	hl, hl
    00000205 29               [11]  564 	add	hl, hl
    00000206 11r00r00         [10]  565 	ld	de, #_sprite_tiles
    00000209 19               [11]  566 	add	hl, de
    0000020A EB               [ 4]  567 	ex	de, hl
    0000020B DD 71 FF         [19]  568 	ld	-1 (ix), c
    0000020E C5               [11]  569 	push	bc
    0000020F D5               [11]  570 	push	de
    00000210 AF               [ 4]  571 	xor	a, a
    00000211 6F               [ 4]  572 	ld	l, a
    00000212 CDrCBr01         [17]  573 	call	_get_tile_offset
    00000215 D1               [10]  574 	pop	de
    00000216 C1               [10]  575 	pop	bc
    00000217 DD 86 FF         [19]  576 	add	a, -1 (ix)
    0000021A C5               [11]  577 	push	bc
    0000021B D5               [11]  578 	push	de
    0000021C 26 00            [ 7]  579 	ld	h, #0x00
    0000021E E5               [11]  580 	push	hl
    0000021F 33               [ 6]  581 	inc	sp
    00000220 26 00            [ 7]  582 	ld	h, #0x00
    00000222 E5               [11]  583 	push	hl
    00000223 33               [ 6]  584 	inc	sp
    00000224 CDr00r00         [17]  585 	call	_set_tile
                                    586 ;src/metasprites.c:131: set_tile(i + get_tile_offset(1, 0), sprite_tiles + (i << 4), 1, 0);
    00000227 2E 00            [ 7]  587 	ld	l, #0x00
    00000229 3E 01            [ 7]  588 	ld	a, #0x01
    0000022B CDrCBr01         [17]  589 	call	_get_tile_offset
    0000022E D1               [10]  590 	pop	de
    0000022F C1               [10]  591 	pop	bc
    00000230 DD 86 FF         [19]  592 	add	a, -1 (ix)
    00000233 C5               [11]  593 	push	bc
    00000234 D5               [11]  594 	push	de
    00000235 26 00            [ 7]  595 	ld	h, #0x00
    00000237 E5               [11]  596 	push	hl
    00000238 33               [ 6]  597 	inc	sp
    00000239 26 01            [ 7]  598 	ld	h, #0x01
    0000023B E5               [11]  599 	push	hl
    0000023C 33               [ 6]  600 	inc	sp
    0000023D CDr00r00         [17]  601 	call	_set_tile
                                    602 ;src/metasprites.c:134: set_tile(i + get_tile_offset(0, 1), sprite_tiles + (i << 4), 0, 1);
    00000240 2E 01            [ 7]  603 	ld	l, #0x01
    00000242 AF               [ 4]  604 	xor	a, a
    00000243 CDrCBr01         [17]  605 	call	_get_tile_offset
    00000246 D1               [10]  606 	pop	de
    00000247 C1               [10]  607 	pop	bc
    00000248 DD 86 FF         [19]  608 	add	a, -1 (ix)
    0000024B C5               [11]  609 	push	bc
    0000024C D5               [11]  610 	push	de
    0000024D 26 01            [ 7]  611 	ld	h, #0x01
    0000024F E5               [11]  612 	push	hl
    00000250 33               [ 6]  613 	inc	sp
    00000251 26 00            [ 7]  614 	ld	h, #0x00
    00000253 E5               [11]  615 	push	hl
    00000254 33               [ 6]  616 	inc	sp
    00000255 CDr00r00         [17]  617 	call	_set_tile
                                    618 ;src/metasprites.c:137: set_tile(i + get_tile_offset(1, 1), sprite_tiles + (i << 4), 1, 1);
    00000258 3E 01            [ 7]  619 	ld	a,#0x01
    0000025A 6F               [ 4]  620 	ld	l,a
    0000025B CDrCBr01         [17]  621 	call	_get_tile_offset
    0000025E D1               [10]  622 	pop	de
    0000025F C1               [10]  623 	pop	bc
    00000260 DD 86 FF         [19]  624 	add	a, -1 (ix)
    00000263 C5               [11]  625 	push	bc
    00000264 26 01            [ 7]  626 	ld	h, #0x01
    00000266 E5               [11]  627 	push	hl
    00000267 33               [ 6]  628 	inc	sp
    00000268 26 01            [ 7]  629 	ld	h, #0x01
    0000026A E5               [11]  630 	push	hl
    0000026B 33               [ 6]  631 	inc	sp
    0000026C CDr00r00         [17]  632 	call	_set_tile
    0000026F C1               [10]  633 	pop	bc
                                    634 ;src/metasprites.c:127: for(i = 0; i < num_tiles; i++)
    00000270 03               [ 6]  635 	inc	bc
    00000271 18 83            [12]  636 	jr	00103$
    00000273                        637 00105$:
                                    638 ;src/metasprites.c:140: }
    00000273 33               [ 6]  639 	inc	sp
    00000274 DD E1            [14]  640 	pop	ix
    00000276 C9               [10]  641 	ret
                                    642 ;src/metasprites.c:160: void main(void) {
                                    643 ;	---------------------------------
                                    644 ; Function main
                                    645 ; ---------------------------------
    00000277                        646 _main::
    00000277 DD E5            [15]  647 	push	ix
    00000279 DD 21 00 00      [14]  648 	ld	ix,#0
    0000027D DD 39            [15]  649 	add	ix,sp
    0000027F 21 F7 FF         [10]  650 	ld	hl, #-9
    00000282 39               [11]  651 	add	hl, sp
    00000283 F9               [ 6]  652 	ld	sp, hl
                                    653 ;../../../include/sms/sms.h:254: __WRITE_VDP_REG(VDP_R1, __READ_VDP_REG(VDP_R1) &= (~R1_DISP_ON));
    00000284 3Ar00r00         [13]  654 	ld	a, (_shadow_VDP_R1+0)
    00000287 E6 BF            [ 7]  655 	and	a, #0xbf
    00000289 32r00r00         [13]  656 	ld	(_shadow_VDP_R1+0), a
    0000028C F3               [ 4]  657 	di
    0000028D 3Ar00r00         [13]  658 	ld	a, (_shadow_VDP_R1+0)
    00000290 D3 BF            [11]  659 	out	(_VDP_CMD), a
    00000292 3E 81            [ 7]  660 	ld	a, #0x81
    00000294 D3 BF            [11]  661 	out	(_VDP_CMD), a
    00000296 FB               [ 4]  662 	ei
                                    663 ;src/metasprites.c:177: fill_bkg_rect(0, 0, DEVICE_SCREEN_WIDTH, DEVICE_SCREEN_HEIGHT, 0);
    00000297 21 00 00         [10]  664 	ld	hl, #0x0000
    0000029A E5               [11]  665 	push	hl
    0000029B 21 20 18         [10]  666 	ld	hl, #0x1820
    0000029E E5               [11]  667 	push	hl
    0000029F 21 00 00         [10]  668 	ld	hl, #0x00
    000002A2 E5               [11]  669 	push	hl
    000002A3 CDr00r00         [17]  670 	call	_fill_rect_compat
                                    671 ;src/metasprites.c:180: set_bkg_data(0, 1, pattern);
                                    672 ;../../../include/sms/sms.h:641: set_tile_2bpp_data(start, ntiles, src, _current_2bpp_palette);
    000002A6 2Ar00r00         [16]  673 	ld	hl, (__current_2bpp_palette)
    000002A9 E5               [11]  674 	push	hl
    000002AA 21rBBr00         [10]  675 	ld	hl, #_pattern
    000002AD E5               [11]  676 	push	hl
    000002AE 21 01 00         [10]  677 	ld	hl, #0x0001
    000002B1 E5               [11]  678 	push	hl
    000002B2 6C               [ 4]  679 	ld	l, h
    000002B3 E5               [11]  680 	push	hl
    000002B4 CDr00r00         [17]  681 	call	_set_tile_2bpp_data
                                    682 ;src/metasprites.c:183: load_and_duplicate_sprite_tile_data();
    000002B7 CDrE4r01         [17]  683 	call	_load_and_duplicate_sprite_tile_data
                                    684 ;src/metasprites.c:186: SHOW_BKG; SHOW_SPRITES;
    000002BA AF               [ 4]  685 	xor	a, a
    000002BB 32r00r00         [13]  686 	ld	(__sprites_OFF+0), a
                                    687 ;src/metasprites.c:192: SPRITES_8x8;
    000002BE 3Ar00r00         [13]  688 	ld	a, (_shadow_VDP_R1+0)
    000002C1 E6 FD            [ 7]  689 	and	a, #0xfd
    000002C3 32r00r00         [13]  690 	ld	(_shadow_VDP_R1+0), a
    000002C6 F3               [ 4]  691 	di
    000002C7 3Ar00r00         [13]  692 	ld	a, (_shadow_VDP_R1+0)
    000002CA D3 BF            [11]  693 	out	(_VDP_CMD), a
    000002CC 3E 81            [ 7]  694 	ld	a, #0x81
    000002CE D3 BF            [11]  695 	out	(_VDP_CMD), a
    000002D0 FB               [ 4]  696 	ei
                                    697 ;src/metasprites.c:194: DISPLAY_ON;
    000002D1 3Ar00r00         [13]  698 	ld	a, (_shadow_VDP_R1+0)
    000002D4 F6 40            [ 7]  699 	or	a, #0x40
    000002D6 32r00r00         [13]  700 	ld	(_shadow_VDP_R1+0), a
    000002D9 F3               [ 4]  701 	di
    000002DA 3Ar00r00         [13]  702 	ld	a, (_shadow_VDP_R1+0)
    000002DD D3 BF            [11]  703 	out	(_VDP_CMD), a
    000002DF 3E 81            [ 7]  704 	ld	a, #0x81
    000002E1 D3 BF            [11]  705 	out	(_VDP_CMD), a
    000002E3 FB               [ 4]  706 	ei
                                    707 ;src/metasprites.c:197: PosX = (DEVICE_SCREEN_PX_WIDTH / 2) << 4;
    000002E4 21 00 08         [10]  708 	ld	hl, #0x0800
    000002E7 22r00r00         [16]  709 	ld	(_PosX), hl
                                    710 ;src/metasprites.c:198: PosY = (DEVICE_SCREEN_PX_HEIGHT / 2) << 4;
    000002EA 26 06            [ 7]  711 	ld	h, #0x06
    000002EC 22r02r00         [16]  712 	ld	(_PosY), hl
                                    713 ;src/metasprites.c:199: SpdX = SpdY = 0;
    000002EF 65               [ 4]  714 	ld	h, l
    000002F0 22r06r00         [16]  715 	ld	(_SpdY), hl
    000002F3 22r04r00         [16]  716 	ld	(_SpdX), hl
                                    717 ;src/metasprites.c:201: idx = 0; rot = 0;
    000002F6 AF               [ 4]  718 	xor	a, a
    000002F7 32r09r00         [13]  719 	ld	(_idx+0), a
    000002FA 32r0Ar00         [13]  720 	ld	(_rot+0), a
                                    721 ;src/metasprites.c:203: while(TRUE) {        
    000002FD                        722 00145$:
                                    723 ;src/metasprites.c:205: KEY_INPUT;
    000002FD 3Ar00r00         [13]  724 	ld	a, (_joyp+0)
    00000300 32r01r00         [13]  725 	ld	(_old_joyp+0), a
    00000303 CDr00r00         [17]  726 	call	_joypad
    00000306 7D               [ 4]  727 	ld	a, l
    00000307 32r00r00         [13]  728 	ld	(_joyp+0), a
                                    729 ;src/metasprites.c:207: PosF = 0;
    0000030A AF               [ 4]  730 	xor	a, a
    0000030B 32r08r00         [13]  731 	ld	(_PosF+0), a
                                    732 ;src/metasprites.c:209: if (KEY_DOWN(J_UP)) {
    0000030E 3Ar00r00         [13]  733 	ld	a, (_joyp+0)
    00000311 DD 77 FE         [19]  734 	ld	-2 (ix), a
                                    735 ;src/metasprites.c:210: SpdY -= 2;
    00000314 2Ar06r00         [16]  736 	ld	hl, (_SpdY)
                                    737 ;src/metasprites.c:212: PosF |= ACC_Y;
    00000317 3Ar08r00         [13]  738 	ld	a, (_PosF+0)
    0000031A F6 02            [ 7]  739 	or	a, #0x02
    0000031C DD 77 FF         [19]  740 	ld	-1 (ix), a
                                    741 ;src/metasprites.c:209: if (KEY_DOWN(J_UP)) {
    0000031F DD CB FE 46      [20]  742 	bit	0, -2 (ix)
    00000323 28 22            [12]  743 	jr	Z, 00108$
                                    744 ;src/metasprites.c:210: SpdY -= 2;
    00000325 2B               [ 6]  745 	dec	hl
    00000326 2B               [ 6]  746 	dec	hl
    00000327 22r06r00         [16]  747 	ld	(_SpdY), hl
                                    748 ;src/metasprites.c:211: if (SpdY < -32) SpdY = -32;
    0000032A 3Ar06r00         [13]  749 	ld	a, (_SpdY+0)
    0000032D D6 E0            [ 7]  750 	sub	a, #0xe0
    0000032F 3Ar07r00         [13]  751 	ld	a, (_SpdY+1)
    00000332 17               [ 4]  752 	rla
    00000333 3F               [ 4]  753 	ccf
    00000334 1F               [ 4]  754 	rra
    00000335 DE 7F            [ 7]  755 	sbc	a, #0x7f
    00000337 30 06            [12]  756 	jr	NC, 00102$
    00000339 21 E0 FF         [10]  757 	ld	hl, #0xffe0
    0000033C 22r06r00         [16]  758 	ld	(_SpdY), hl
    0000033F                        759 00102$:
                                    760 ;src/metasprites.c:212: PosF |= ACC_Y;
    0000033F DD 7E FF         [19]  761 	ld	a, -1 (ix)
    00000342 32r08r00         [13]  762 	ld	(_PosF+0), a
    00000345 18 2B            [12]  763 	jr	00109$
    00000347                        764 00108$:
                                    765 ;src/metasprites.c:213: } else if (KEY_DOWN(J_DOWN)) {
    00000347 DD CB FE 4E      [20]  766 	bit	1, -2 (ix)
    0000034B 28 25            [12]  767 	jr	Z, 00109$
                                    768 ;src/metasprites.c:214: SpdY += 2;
    0000034D 23               [ 6]  769 	inc	hl
    0000034E 23               [ 6]  770 	inc	hl
    0000034F 4D               [ 4]  771 	ld	c, l
    00000350 44               [ 4]  772 	ld	b, h
    00000351 ED 43r06r00      [20]  773 	ld	(_SpdY), bc
                                    774 ;src/metasprites.c:215: if (SpdY > 32) SpdY = 32;
    00000355 2Ar06r00         [16]  775 	ld	hl, (_SpdY)
    00000358 3E 20            [ 7]  776 	ld	a, #0x20
    0000035A BD               [ 4]  777 	cp	a, l
    0000035B 3E 00            [ 7]  778 	ld	a, #0x00
    0000035D 9C               [ 4]  779 	sbc	a, h
    0000035E E2r63r03         [10]  780 	jp	PO, 00322$
    00000361 EE 80            [ 7]  781 	xor	a, #0x80
    00000363                        782 00322$:
    00000363 F2r6Cr03         [10]  783 	jp	P, 00104$
    00000366 21 20 00         [10]  784 	ld	hl, #0x0020
    00000369 22r06r00         [16]  785 	ld	(_SpdY), hl
    0000036C                        786 00104$:
                                    787 ;src/metasprites.c:216: PosF |= ACC_Y;
    0000036C DD 7E FF         [19]  788 	ld	a, -1 (ix)
    0000036F 32r08r00         [13]  789 	ld	(_PosF+0), a
    00000372                        790 00109$:
                                    791 ;src/metasprites.c:220: SpdX -= 2;
    00000372 ED 5Br04r00      [20]  792 	ld	de, (_SpdX)
                                    793 ;src/metasprites.c:222: PosF |= ACC_X;
    00000376 3Ar08r00         [13]  794 	ld	a, (_PosF+0)
    00000379 F6 01            [ 7]  795 	or	a, #0x01
    0000037B DD 77 FF         [19]  796 	ld	-1 (ix), a
                                    797 ;src/metasprites.c:219: if (KEY_DOWN(J_LEFT)) {
    0000037E DD CB FE 56      [20]  798 	bit	2, -2 (ix)
    00000382 28 23            [12]  799 	jr	Z, 00117$
                                    800 ;src/metasprites.c:220: SpdX -= 2;
    00000384 1B               [ 6]  801 	dec	de
    00000385 1B               [ 6]  802 	dec	de
    00000386 ED 53r04r00      [20]  803 	ld	(_SpdX), de
                                    804 ;src/metasprites.c:221: if (SpdX < -32) SpdX = -32;
    0000038A 3Ar04r00         [13]  805 	ld	a, (_SpdX+0)
    0000038D D6 E0            [ 7]  806 	sub	a, #0xe0
    0000038F 3Ar05r00         [13]  807 	ld	a, (_SpdX+1)
    00000392 17               [ 4]  808 	rla
    00000393 3F               [ 4]  809 	ccf
    00000394 1F               [ 4]  810 	rra
    00000395 DE 7F            [ 7]  811 	sbc	a, #0x7f
    00000397 30 06            [12]  812 	jr	NC, 00111$
    00000399 21 E0 FF         [10]  813 	ld	hl, #0xffe0
    0000039C 22r04r00         [16]  814 	ld	(_SpdX), hl
    0000039F                        815 00111$:
                                    816 ;src/metasprites.c:222: PosF |= ACC_X;
    0000039F DD 7E FF         [19]  817 	ld	a, -1 (ix)
    000003A2 32r08r00         [13]  818 	ld	(_PosF+0), a
    000003A5 18 29            [12]  819 	jr	00118$
    000003A7                        820 00117$:
                                    821 ;src/metasprites.c:223: } else if (KEY_DOWN(J_RIGHT)) {
    000003A7 DD CB FE 5E      [20]  822 	bit	3, -2 (ix)
    000003AB 28 23            [12]  823 	jr	Z, 00118$
                                    824 ;src/metasprites.c:224: SpdX += 2;
    000003AD 13               [ 6]  825 	inc	de
    000003AE 13               [ 6]  826 	inc	de
    000003AF ED 53r04r00      [20]  827 	ld	(_SpdX), de
                                    828 ;src/metasprites.c:225: if (SpdX > 32) SpdX = 32;
    000003B3 2Ar04r00         [16]  829 	ld	hl, (_SpdX)
    000003B6 3E 20            [ 7]  830 	ld	a, #0x20
    000003B8 BD               [ 4]  831 	cp	a, l
    000003B9 3E 00            [ 7]  832 	ld	a, #0x00
    000003BB 9C               [ 4]  833 	sbc	a, h
    000003BC E2rC1r03         [10]  834 	jp	PO, 00325$
    000003BF EE 80            [ 7]  835 	xor	a, #0x80
    000003C1                        836 00325$:
    000003C1 F2rCAr03         [10]  837 	jp	P, 00113$
    000003C4 21 20 00         [10]  838 	ld	hl, #0x0020
    000003C7 22r04r00         [16]  839 	ld	(_SpdX), hl
    000003CA                        840 00113$:
                                    841 ;src/metasprites.c:226: PosF |= ACC_X;
    000003CA DD 7E FF         [19]  842 	ld	a, -1 (ix)
    000003CD 32r08r00         [13]  843 	ld	(_PosF+0), a
    000003D0                        844 00118$:
                                    845 ;src/metasprites.c:230: if (KEY_PRESSED(J_B)) {
    000003D0 3Ar00r00         [13]  846 	ld	a, (_joyp+0)
    000003D3 21r01r00         [10]  847 	ld	hl, #_old_joyp
    000003D6 AE               [ 7]  848 	xor	a, (hl)
    000003D7 21r00r00         [10]  849 	ld	hl, #_joyp
    000003DA A6               [ 7]  850 	and	a, (hl)
    000003DB 4F               [ 4]  851 	ld	c, a
    000003DC CB 61            [ 8]  852 	bit	4, c
    000003DE 28 12            [12]  853 	jr	Z, 00122$
                                    854 ;src/metasprites.c:231: idx++; if (idx >= (sizeof(sprite_metasprites) >> 1)) idx = 0;
    000003E0 FD 21r09r00      [14]  855 	ld	iy, #_idx
    000003E4 FD 34 00         [23]  856 	inc	0 (iy)
    000003E7 3Ar09r00         [13]  857 	ld	a, (_idx+0)
    000003EA D6 05            [ 7]  858 	sub	a, #0x05
    000003EC 38 04            [12]  859 	jr	C, 00122$
    000003EE FD 36 00 00      [19]  860 	ld	0 (iy), #0x00
    000003F2                        861 00122$:
                                    862 ;src/metasprites.c:235: if (KEY_PRESSED(J_A)) {
    000003F2 CB 69            [ 8]  863 	bit	5, c
    000003F4 28 0C            [12]  864 	jr	Z, 00124$
                                    865 ;src/metasprites.c:236: rot++; rot &= 0xF;
    000003F6 21r0Ar00         [10]  866 	ld	hl, #_rot
    000003F9 34               [11]  867 	inc	(hl)
    000003FA 3Ar0Ar00         [13]  868 	ld	a, (_rot+0)
    000003FD E6 0F            [ 7]  869 	and	a, #0x0f
    000003FF 32r0Ar00         [13]  870 	ld	(_rot+0), a
    00000402                        871 00124$:
                                    872 ;src/metasprites.c:239: PosX += SpdX, PosY += SpdY; 
    00000402 21r04r00         [10]  873 	ld	hl, #_SpdX
    00000405 D5               [11]  874 	push	de
    00000406 11r00r00         [10]  875 	ld	de, #_PosX
    00000409 1A               [ 7]  876 	ld	a, (de)
    0000040A 86               [ 7]  877 	add	a, (hl)
    0000040B 23               [ 6]  878 	inc	hl
    0000040C 12               [ 7]  879 	ld	(de), a
    0000040D 13               [ 6]  880 	inc	de
    0000040E 1A               [ 7]  881 	ld	a, (de)
    0000040F 8E               [ 7]  882 	adc	a, (hl)
    00000410 12               [ 7]  883 	ld	(de), a
    00000411 21r06r00         [10]  884 	ld	hl, #_SpdY
    00000414 11r02r00         [10]  885 	ld	de, #_PosY
    00000417 1A               [ 7]  886 	ld	a, (de)
    00000418 86               [ 7]  887 	add	a, (hl)
    00000419 23               [ 6]  888 	inc	hl
    0000041A 12               [ 7]  889 	ld	(de), a
    0000041B 13               [ 6]  890 	inc	de
    0000041C 1A               [ 7]  891 	ld	a, (de)
    0000041D 8E               [ 7]  892 	adc	a, (hl)
    0000041E 12               [ 7]  893 	ld	(de), a
    0000041F D1               [10]  894 	pop	de
                                    895 ;src/metasprites.c:251: switch (rot & 0x3) {
    00000420 3Ar0Ar00         [13]  896 	ld	a, (_rot)
    00000423 E6 03            [ 7]  897 	and	a, #0x03
    00000425 DD 77 FB         [19]  898 	ld	-5 (ix), a
                                    899 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000428 3Ar02r00         [13]  900 	ld	a, (_PosY+0)
    0000042B DD 77 FC         [19]  901 	ld	-4 (ix), a
    0000042E 3Ar03r00         [13]  902 	ld	a, (_PosY+1)
    00000431 DD 77 FD         [19]  903 	ld	-3 (ix), a
    00000434 DD CB FD 2E      [23]  904 	sra	-3 (ix)
    00000438 DD CB FC 1E      [23]  905 	rr	-4 (ix)
    0000043C DD CB FD 2E      [23]  906 	sra	-3 (ix)
    00000440 DD CB FC 1E      [23]  907 	rr	-4 (ix)
    00000444 DD CB FD 2E      [23]  908 	sra	-3 (ix)
    00000448 DD CB FC 1E      [23]  909 	rr	-4 (ix)
    0000044C DD CB FD 2E      [23]  910 	sra	-3 (ix)
    00000450 DD CB FC 1E      [23]  911 	rr	-4 (ix)
                                    912 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    00000454 3Ar00r00         [13]  913 	ld	a, (_PosX+0)
    00000457 DD 77 FE         [19]  914 	ld	-2 (ix), a
    0000045A 3Ar01r00         [13]  915 	ld	a, (_PosX+1)
    0000045D DD 77 FF         [19]  916 	ld	-1 (ix), a
    00000460 DD CB FF 2E      [23]  917 	sra	-1 (ix)
    00000464 DD CB FE 1E      [23]  918 	rr	-2 (ix)
    00000468 DD CB FF 2E      [23]  919 	sra	-1 (ix)
    0000046C DD CB FE 1E      [23]  920 	rr	-2 (ix)
    00000470 DD CB FF 2E      [23]  921 	sra	-1 (ix)
    00000474 DD CB FE 1E      [23]  922 	rr	-2 (ix)
    00000478 DD CB FF 2E      [23]  923 	sra	-1 (ix)
    0000047C DD CB FE 1E      [23]  924 	rr	-2 (ix)
                                    925 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000480 DD 7E FC         [19]  926 	ld	a, -4 (ix)
    00000483 DD 77 F9         [19]  927 	ld	-7 (ix), a
    00000486 DD 7E FD         [19]  928 	ld	a, -3 (ix)
    00000489 DD 77 FA         [19]  929 	ld	-6 (ix), a
    0000048C DD 7E F9         [19]  930 	ld	a, -7 (ix)
    0000048F C6 FF            [ 7]  931 	add	a, #0xff
    00000491 DD 77 FC         [19]  932 	ld	-4 (ix), a
    00000494 DD 7E FA         [19]  933 	ld	a, -6 (ix)
    00000497 CE FF            [ 7]  934 	adc	a, #0xff
    00000499 DD 77 FD         [19]  935 	ld	-3 (ix), a
                                    936 ;src/metasprites.c:251: switch (rot & 0x3) {
    0000049C DD 7E FB         [19]  937 	ld	a, -5 (ix)
    0000049F 3D               [ 4]  938 	dec	a
    000004A0 28 12            [12]  939 	jr	Z, 00125$
    000004A2 DD 7E FB         [19]  940 	ld	a, -5 (ix)
    000004A5 D6 02            [ 7]  941 	sub	a, #0x02
    000004A7 28 60            [12]  942 	jr	Z, 00126$
    000004A9 DD 7E FB         [19]  943 	ld	a, -5 (ix)
    000004AC D6 03            [ 7]  944 	sub	a, #0x03
    000004AE CAr6Fr05         [10]  945 	jp	Z, 00127$
    000004B1 C3r17r06         [10]  946 	jp	00128$
                                    947 ;src/metasprites.c:252: case 1:
    000004B4                        948 00125$:
                                    949 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    000004B4 DD 4E FC         [19]  950 	ld	c, -4 (ix)
    000004B7 DD 46 FD         [19]  951 	ld	b, -3 (ix)
                                    952 ;src/metasprites.c:257: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    000004BA DD 5E FE         [19]  953 	ld	e, -2 (ix)
    000004BD DD 56 FF         [19]  954 	ld	d, -1 (ix)
                                    955 ;src/metasprites.c:254: TILE_NUM_START + get_tile_offset(0, 1),
    000004C0 C5               [11]  956 	push	bc
    000004C1 D5               [11]  957 	push	de
    000004C2 2E 01            [ 7]  958 	ld	l, #0x01
    000004C4 AF               [ 4]  959 	xor	a, a
    000004C5 CDrCBr01         [17]  960 	call	_get_tile_offset
    000004C8 DD 77 FF         [19]  961 	ld	-1 (ix), a
    000004CB D1               [10]  962 	pop	de
    000004CC C1               [10]  963 	pop	bc
                                    964 ;src/metasprites.c:253: hiwater += move_metasprite_flipy( sprite_metasprites[idx],
    000004CD 3Ar09r00         [13]  965 	ld	a, (_idx)
    000004D0 6F               [ 4]  966 	ld	l, a
    000004D1 26 00            [ 7]  967 	ld	h, #0x00
    000004D3 29               [11]  968 	add	hl, hl
    000004D4 7D               [ 4]  969 	ld	a, l
    000004D5 C6r00            [ 7]  970 	add	a, #<(_sprite_metasprites)
    000004D7 6F               [ 4]  971 	ld	l, a
    000004D8 7C               [ 4]  972 	ld	a, h
    000004D9 CEs00            [ 7]  973 	adc	a, #>(_sprite_metasprites)
    000004DB 67               [ 4]  974 	ld	h, a
    000004DC 7E               [ 7]  975 	ld	a, (hl)
    000004DD 23               [ 6]  976 	inc	hl
    000004DE 66               [ 7]  977 	ld	h, (hl)
    000004DF 6F               [ 4]  978 	ld	l, a
                                    979 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
                                    980 ;../../../include/sms/metasprites.h:149: __current_metasprite = metasprite;
    000004E0 22r00r00         [16]  981 	ld	(___current_metasprite), hl
                                    982 ;../../../include/sms/metasprites.h:150: __current_base_tile = base_tile;
    000004E3 DD 7E FF         [19]  983 	ld	a, -1 (ix)
    000004E6 32r00r00         [13]  984 	ld	(___current_base_tile+0), a
                                    985 ;../../../include/sms/metasprites.h:151: return __move_metasprite_flipy(base_sprite, x, y - ((__READ_VDP_REG(VDP_R1) & R1_SPR_8X16) ? 16 : 8) );
    000004E9 3Ar00r00         [13]  986 	ld	a, (_shadow_VDP_R1)
    000004EC CB 4F            [ 8]  987 	bit	1, a
    000004EE 28 05            [12]  988 	jr	Z, 00155$
    000004F0 21 10 00         [10]  989 	ld	hl, #0x0010
    000004F3 18 03            [12]  990 	jr	00156$
    000004F5                        991 00155$:
    000004F5 21 08 00         [10]  992 	ld	hl, #0x0008
    000004F8                        993 00156$:
    000004F8 79               [ 4]  994 	ld	a, c
    000004F9 95               [ 4]  995 	sub	a, l
    000004FA 4F               [ 4]  996 	ld	c, a
    000004FB 78               [ 4]  997 	ld	a, b
    000004FC 9C               [ 4]  998 	sbc	a, h
    000004FD 47               [ 4]  999 	ld	b, a
    000004FE C5               [11] 1000 	push	bc
    000004FF AF               [ 4] 1001 	xor	a, a
    00000500 CDr00r00         [17] 1002 	call	___move_metasprite_flipy
                                   1003 ;src/metasprites.c:258: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000503 DD 77 FF         [19] 1004 	ld	-1 (ix), a
                                   1005 ;src/metasprites.c:259: break;
    00000506 C3r93r06         [10] 1006 	jp	00129$
                                   1007 ;src/metasprites.c:260: case 2:
    00000509                       1008 00126$:
                                   1009 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000509 DD 5E FC         [19] 1010 	ld	e, -4 (ix)
    0000050C DD 56 FD         [19] 1011 	ld	d, -3 (ix)
                                   1012 ;src/metasprites.c:265: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    0000050F DD 4E FE         [19] 1013 	ld	c, -2 (ix)
    00000512 DD 46 FF         [19] 1014 	ld	b, -1 (ix)
                                   1015 ;src/metasprites.c:262: TILE_NUM_START + get_tile_offset(1, 1),
    00000515 C5               [11] 1016 	push	bc
    00000516 D5               [11] 1017 	push	de
    00000517 3E 01            [ 7] 1018 	ld	a,#0x01
    00000519 6F               [ 4] 1019 	ld	l,a
    0000051A CDrCBr01         [17] 1020 	call	_get_tile_offset
    0000051D DD 77 FD         [19] 1021 	ld	-3 (ix), a
    00000520 D1               [10] 1022 	pop	de
    00000521 C1               [10] 1023 	pop	bc
                                   1024 ;src/metasprites.c:261: hiwater += move_metasprite_flipxy(sprite_metasprites[idx],
    00000522 3Ar09r00         [13] 1025 	ld	a, (_idx)
    00000525 6F               [ 4] 1026 	ld	l, a
    00000526 26 00            [ 7] 1027 	ld	h, #0x00
    00000528 29               [11] 1028 	add	hl, hl
    00000529 7D               [ 4] 1029 	ld	a, l
    0000052A C6r00            [ 7] 1030 	add	a, #<(_sprite_metasprites)
    0000052C 6F               [ 4] 1031 	ld	l, a
    0000052D 7C               [ 4] 1032 	ld	a, h
    0000052E CEs00            [ 7] 1033 	adc	a, #>(_sprite_metasprites)
    00000530 67               [ 4] 1034 	ld	h, a
    00000531 7E               [ 7] 1035 	ld	a, (hl)
    00000532 23               [ 6] 1036 	inc	hl
    00000533 66               [ 7] 1037 	ld	h, (hl)
    00000534 6F               [ 4] 1038 	ld	l, a
                                   1039 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000535 DD 73 FE         [19] 1040 	ld	-2 (ix), e
    00000538 DD 72 FF         [19] 1041 	ld	-1 (ix), d
                                   1042 ;../../../include/sms/metasprites.h:178: __current_metasprite = metasprite;
    0000053B 22r00r00         [16] 1043 	ld	(___current_metasprite), hl
                                   1044 ;../../../include/sms/metasprites.h:179: __current_base_tile = base_tile;
    0000053E DD 7E FD         [19] 1045 	ld	a, -3 (ix)
    00000541 32r00r00         [13] 1046 	ld	(___current_base_tile+0), a
                                   1047 ;../../../include/sms/metasprites.h:180: return __move_metasprite_flipxy(base_sprite, x - 8, y - ((__READ_VDP_REG(VDP_R1) & R1_SPR_8X16) ? 16 : 8));
    00000544 3Ar00r00         [13] 1048 	ld	a, (_shadow_VDP_R1)
    00000547 CB 4F            [ 8] 1049 	bit	1, a
    00000549 28 05            [12] 1050 	jr	Z, 00157$
    0000054B 11 10 00         [10] 1051 	ld	de, #0x0010
    0000054E 18 03            [12] 1052 	jr	00158$
    00000550                       1053 00157$:
    00000550 11 08 00         [10] 1054 	ld	de, #0x0008
    00000553                       1055 00158$:
    00000553 DD 6E FE         [19] 1056 	ld	l, -2 (ix)
    00000556 DD 66 FF         [19] 1057 	ld	h, -1 (ix)
    00000559 BF               [ 4] 1058 	cp	a, a
    0000055A ED 52            [15] 1059 	sbc	hl, de
    0000055C 79               [ 4] 1060 	ld	a, c
    0000055D C6 F8            [ 7] 1061 	add	a, #0xf8
    0000055F 5F               [ 4] 1062 	ld	e, a
    00000560 78               [ 4] 1063 	ld	a, b
    00000561 CE FF            [ 7] 1064 	adc	a, #0xff
    00000563 57               [ 4] 1065 	ld	d, a
    00000564 E5               [11] 1066 	push	hl
    00000565 AF               [ 4] 1067 	xor	a, a
    00000566 CDr00r00         [17] 1068 	call	___move_metasprite_flipxy
                                   1069 ;src/metasprites.c:266: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000569 DD 77 FF         [19] 1070 	ld	-1 (ix), a
                                   1071 ;src/metasprites.c:267: break;
    0000056C C3r93r06         [10] 1072 	jp	00129$
                                   1073 ;src/metasprites.c:268: case 3:
    0000056F                       1074 00127$:
                                   1075 ;src/metasprites.c:274: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    0000056F DD 7E FC         [19] 1076 	ld	a, -4 (ix)
    00000572 DD 77 F9         [19] 1077 	ld	-7 (ix), a
    00000575 DD 7E FD         [19] 1078 	ld	a, -3 (ix)
    00000578 DD 77 FA         [19] 1079 	ld	-6 (ix), a
                                   1080 ;src/metasprites.c:273: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    0000057B DD 7E FE         [19] 1081 	ld	a, -2 (ix)
    0000057E DD 77 FB         [19] 1082 	ld	-5 (ix), a
    00000581 DD 7E FF         [19] 1083 	ld	a, -1 (ix)
    00000584 DD 77 FC         [19] 1084 	ld	-4 (ix), a
                                   1085 ;src/metasprites.c:270: TILE_NUM_START + get_tile_offset(1, 0),
    00000587 2E 00            [ 7] 1086 	ld	l, #0x00
    00000589 3E 01            [ 7] 1087 	ld	a, #0x01
    0000058B CDrCBr01         [17] 1088 	call	_get_tile_offset
    0000058E DD 77 FD         [19] 1089 	ld	-3 (ix), a
                                   1090 ;src/metasprites.c:269: hiwater += move_metasprite_flipx( sprite_metasprites[idx],
    00000591 3Ar09r00         [13] 1091 	ld	a, (_idx+0)
    00000594 DD 77 FE         [19] 1092 	ld	-2 (ix), a
    00000597 DD 36 FF 00      [19] 1093 	ld	-1 (ix), #0x00
    0000059B DD 7E FE         [19] 1094 	ld	a, -2 (ix)
    0000059E DD 77 F7         [19] 1095 	ld	-9 (ix), a
    000005A1 DD 36 F8 00      [19] 1096 	ld	-8 (ix), #0x00
    000005A5 DD CB F7 26      [23] 1097 	sla	-9 (ix)
    000005A9 DD CB F8 16      [23] 1098 	rl	-8 (ix)
    000005AD DD 7E F7         [19] 1099 	ld	a, -9 (ix)
    000005B0 C6r00            [ 7] 1100 	add	a, #<(_sprite_metasprites)
    000005B2 DD 77 FE         [19] 1101 	ld	-2 (ix), a
    000005B5 DD 7E F8         [19] 1102 	ld	a, -8 (ix)
    000005B8 CEs00            [ 7] 1103 	adc	a, #>(_sprite_metasprites)
    000005BA DD 77 FF         [19] 1104 	ld	-1 (ix), a
    000005BD DD 6E FE         [19] 1105 	ld	l, -2 (ix)
    000005C0 DD 66 FF         [19] 1106 	ld	h, -1 (ix)
    000005C3 7E               [ 7] 1107 	ld	a, (hl)
    000005C4 DD 77 FE         [19] 1108 	ld	-2 (ix), a
    000005C7 23               [ 6] 1109 	inc	hl
    000005C8 7E               [ 7] 1110 	ld	a, (hl)
    000005C9 DD 77 FF         [19] 1111 	ld	-1 (ix), a
                                   1112 ;../../../include/sms/metasprites.h:120: __current_metasprite = metasprite;
    000005CC DD 6E FE         [19] 1113 	ld	l, -2 (ix)
    000005CF DD 66 FF         [19] 1114 	ld	h, -1 (ix)
    000005D2 22r00r00         [16] 1115 	ld	(___current_metasprite), hl
                                   1116 ;../../../include/sms/metasprites.h:121: __current_base_tile = base_tile;
    000005D5 DD 7E FD         [19] 1117 	ld	a, -3 (ix)
    000005D8 32r00r00         [13] 1118 	ld	(___current_base_tile+0), a
                                   1119 ;../../../include/sms/metasprites.h:122: return __move_metasprite_flipx(base_sprite, x - 8, y);
    000005DB DD 7E FB         [19] 1120 	ld	a, -5 (ix)
    000005DE DD 77 FE         [19] 1121 	ld	-2 (ix), a
    000005E1 DD 7E FC         [19] 1122 	ld	a, -4 (ix)
    000005E4 DD 77 FF         [19] 1123 	ld	-1 (ix), a
    000005E7 DD 7E FE         [19] 1124 	ld	a, -2 (ix)
    000005EA C6 F8            [ 7] 1125 	add	a, #0xf8
    000005EC DD 77 FC         [19] 1126 	ld	-4 (ix), a
    000005EF DD 7E FF         [19] 1127 	ld	a, -1 (ix)
    000005F2 CE FF            [ 7] 1128 	adc	a, #0xff
    000005F4 DD 77 FD         [19] 1129 	ld	-3 (ix), a
    000005F7 DD 7E FC         [19] 1130 	ld	a, -4 (ix)
    000005FA DD 77 FE         [19] 1131 	ld	-2 (ix), a
    000005FD DD 7E FD         [19] 1132 	ld	a, -3 (ix)
    00000600 DD 77 FF         [19] 1133 	ld	-1 (ix), a
    00000603 D1               [10] 1134 	pop	de
    00000604 E1               [10] 1135 	pop	hl
    00000605 E5               [11] 1136 	push	hl
    00000606 D5               [11] 1137 	push	de
    00000607 E5               [11] 1138 	push	hl
    00000608 DD 5E FE         [19] 1139 	ld	e, -2 (ix)
    0000060B DD 56 FF         [19] 1140 	ld	d, -1 (ix)
    0000060E AF               [ 4] 1141 	xor	a, a
    0000060F CDr00r00         [17] 1142 	call	___move_metasprite_flipx
    00000612 DD 77 FF         [19] 1143 	ld	-1 (ix), a
                                   1144 ;src/metasprites.c:275: break;
    00000615 18 7C            [12] 1145 	jr	00129$
                                   1146 ;src/metasprites.c:276: default:
    00000617                       1147 00128$:
                                   1148 ;src/metasprites.c:282: DEVICE_SPRITE_PX_OFFSET_Y + (PosY >> 4));
    00000617 DD 7E FC         [19] 1149 	ld	a, -4 (ix)
    0000061A DD 77 F9         [19] 1150 	ld	-7 (ix), a
    0000061D DD 7E FD         [19] 1151 	ld	a, -3 (ix)
    00000620 DD 77 FA         [19] 1152 	ld	-6 (ix), a
                                   1153 ;src/metasprites.c:281: DEVICE_SPRITE_PX_OFFSET_X + (PosX >> 4),
    00000623 DD 7E FE         [19] 1154 	ld	a, -2 (ix)
    00000626 DD 77 FB         [19] 1155 	ld	-5 (ix), a
    00000629 DD 7E FF         [19] 1156 	ld	a, -1 (ix)
    0000062C DD 77 FC         [19] 1157 	ld	-4 (ix), a
                                   1158 ;src/metasprites.c:278: TILE_NUM_START + get_tile_offset(0, 0),
    0000062F AF               [ 4] 1159 	xor	a, a
    00000630 6F               [ 4] 1160 	ld	l, a
    00000631 CDrCBr01         [17] 1161 	call	_get_tile_offset
    00000634 DD 77 FD         [19] 1162 	ld	-3 (ix), a
                                   1163 ;src/metasprites.c:277: hiwater += move_metasprite_ex(    sprite_metasprites[idx],
    00000637 3Ar09r00         [13] 1164 	ld	a, (_idx+0)
    0000063A DD 77 FE         [19] 1165 	ld	-2 (ix), a
    0000063D DD 36 FF 00      [19] 1166 	ld	-1 (ix), #0x00
    00000641 DD 7E FE         [19] 1167 	ld	a, -2 (ix)
    00000644 DD 77 F7         [19] 1168 	ld	-9 (ix), a
    00000647 DD 36 F8 00      [19] 1169 	ld	-8 (ix), #0x00
    0000064B DD CB F7 26      [23] 1170 	sla	-9 (ix)
    0000064F DD CB F8 16      [23] 1171 	rl	-8 (ix)
    00000653 DD 7E F7         [19] 1172 	ld	a, -9 (ix)
    00000656 C6r00            [ 7] 1173 	add	a, #<(_sprite_metasprites)
    00000658 DD 77 FE         [19] 1174 	ld	-2 (ix), a
    0000065B DD 7E F8         [19] 1175 	ld	a, -8 (ix)
    0000065E CEs00            [ 7] 1176 	adc	a, #>(_sprite_metasprites)
    00000660 DD 77 FF         [19] 1177 	ld	-1 (ix), a
    00000663 DD 6E FE         [19] 1178 	ld	l, -2 (ix)
    00000666 DD 66 FF         [19] 1179 	ld	h, -1 (ix)
    00000669 7E               [ 7] 1180 	ld	a, (hl)
    0000066A DD 77 FE         [19] 1181 	ld	-2 (ix), a
    0000066D 23               [ 6] 1182 	inc	hl
    0000066E 7E               [ 7] 1183 	ld	a, (hl)
    0000066F DD 77 FF         [19] 1184 	ld	-1 (ix), a
                                   1185 ;../../../include/sms/metasprites.h:83: __current_metasprite = metasprite;
    00000672 DD 6E FE         [19] 1186 	ld	l, -2 (ix)
    00000675 DD 66 FF         [19] 1187 	ld	h, -1 (ix)
    00000678 22r00r00         [16] 1188 	ld	(___current_metasprite), hl
                                   1189 ;../../../include/sms/metasprites.h:84: __current_base_tile = base_tile;
    0000067B DD 7E FD         [19] 1190 	ld	a, -3 (ix)
    0000067E 32r00r00         [13] 1191 	ld	(___current_base_tile+0), a
                                   1192 ;../../../include/sms/metasprites.h:85: return __move_metasprite(base_sprite, x, y);
    00000681 D1               [10] 1193 	pop	de
    00000682 E1               [10] 1194 	pop	hl
    00000683 E5               [11] 1195 	push	hl
    00000684 D5               [11] 1196 	push	de
    00000685 E5               [11] 1197 	push	hl
    00000686 DD 5E FB         [19] 1198 	ld	e, -5 (ix)
    00000689 DD 56 FC         [19] 1199 	ld	d, -4 (ix)
    0000068C AF               [ 4] 1200 	xor	a, a
    0000068D CDr00r00         [17] 1201 	call	___move_metasprite
    00000690 DD 77 FF         [19] 1202 	ld	-1 (ix), a
                                   1203 ;src/metasprites.c:284: }
    00000693                       1204 00129$:
                                   1205 ;src/metasprites.c:287: hide_sprites_range(hiwater, MAX_HARDWARE_SPRITES);        
    00000693 2E 40            [ 7] 1206 	ld	l, #0x40
    00000695 DD 7E FF         [19] 1207 	ld	a, -1 (ix)
    00000698 CDr00r00         [17] 1208 	call	_hide_sprites_range
                                   1209 ;src/metasprites.c:290: if (!(PosF & ACC_Y)) {
    0000069B 3Ar08r00         [13] 1210 	ld	a, (_PosF)
    0000069E 4F               [ 4] 1211 	ld	c, a
    0000069F CB 49            [ 8] 1212 	bit	1, c
    000006A1 20 27            [12] 1213 	jr	NZ, 00136$
                                   1214 ;src/metasprites.c:291: if (SpdY != 0) {
    000006A3 3Ar07r00         [13] 1215 	ld	a, (_SpdY+1)
    000006A6 21r06r00         [10] 1216 	ld	hl, #_SpdY
    000006A9 B6               [ 7] 1217 	or	a, (hl)
    000006AA 28 1E            [12] 1218 	jr	Z, 00136$
                                   1219 ;src/metasprites.c:292: if (SpdY > 0) SpdY--;
    000006AC 2Ar06r00         [16] 1220 	ld	hl, (_SpdY)
    000006AF AF               [ 4] 1221 	xor	a, a
    000006B0 BD               [ 4] 1222 	cp	a, l
    000006B1 9C               [ 4] 1223 	sbc	a, h
    000006B2 E2rB7r06         [10] 1224 	jp	PO, 00337$
    000006B5 EE 80            [ 7] 1225 	xor	a, #0x80
    000006B7                       1226 00337$:
    000006B7 F2rC3r06         [10] 1227 	jp	P, 00131$
    000006BA 2Ar06r00         [16] 1228 	ld	hl, (_SpdY)
    000006BD 2B               [ 6] 1229 	dec	hl
    000006BE 22r06r00         [16] 1230 	ld	(_SpdY), hl
    000006C1 18 07            [12] 1231 	jr	00136$
    000006C3                       1232 00131$:
                                   1233 ;src/metasprites.c:293: else SpdY ++;
    000006C3 2Ar06r00         [16] 1234 	ld	hl, (_SpdY)
    000006C6 23               [ 6] 1235 	inc	hl
    000006C7 22r06r00         [16] 1236 	ld	(_SpdY), hl
    000006CA                       1237 00136$:
                                   1238 ;src/metasprites.c:298: if (!(PosF & ACC_X)) {
    000006CA CB 41            [ 8] 1239 	bit	0, c
    000006CC 20 27            [12] 1240 	jr	NZ, 00143$
                                   1241 ;src/metasprites.c:299: if (SpdX != 0) {
    000006CE 3Ar05r00         [13] 1242 	ld	a, (_SpdX+1)
    000006D1 21r04r00         [10] 1243 	ld	hl, #_SpdX
    000006D4 B6               [ 7] 1244 	or	a, (hl)
    000006D5 28 1E            [12] 1245 	jr	Z, 00143$
                                   1246 ;src/metasprites.c:300: if (SpdX > 0) SpdX--;
    000006D7 2Ar04r00         [16] 1247 	ld	hl, (_SpdX)
    000006DA AF               [ 4] 1248 	xor	a, a
    000006DB BD               [ 4] 1249 	cp	a, l
    000006DC 9C               [ 4] 1250 	sbc	a, h
    000006DD E2rE2r06         [10] 1251 	jp	PO, 00340$
    000006E0 EE 80            [ 7] 1252 	xor	a, #0x80
    000006E2                       1253 00340$:
    000006E2 F2rEEr06         [10] 1254 	jp	P, 00138$
    000006E5 2Ar04r00         [16] 1255 	ld	hl, (_SpdX)
    000006E8 2B               [ 6] 1256 	dec	hl
    000006E9 22r04r00         [16] 1257 	ld	(_SpdX), hl
    000006EC 18 07            [12] 1258 	jr	00143$
    000006EE                       1259 00138$:
                                   1260 ;src/metasprites.c:301: else SpdX ++;
    000006EE 2Ar04r00         [16] 1261 	ld	hl, (_SpdX)
    000006F1 23               [ 6] 1262 	inc	hl
    000006F2 22r04r00         [16] 1263 	ld	(_SpdX), hl
    000006F5                       1264 00143$:
                                   1265 ;src/metasprites.c:307: vsync();
    000006F5 CDr00r00         [17] 1266 	call	_vsync
                                   1267 ;src/metasprites.c:309: }
    000006F8 C3rFDr02         [10] 1268 	jp	00145$
    000006FB                       1269 _gray_pal:
    000006FB 3F                    1270 	.db #0x3f	; 63
    000006FC 2A                    1271 	.db #0x2a	; 42
    000006FD 15                    1272 	.db #0x15	; 21
    000006FE 00                    1273 	.db #0x00	; 0
    000006FF                       1274 _pink_pal:
    000006FF 3F                    1275 	.db #0x3f	; 63
    00000700 33                    1276 	.db #0x33	; 51	'3'
    00000701 22                    1277 	.db #0x22	; 34
    00000702 11                    1278 	.db #0x11	; 17
    00000703                       1279 _cyan_pal:
    00000703 3F                    1280 	.db #0x3f	; 63
    00000704 3D                    1281 	.db #0x3d	; 61
    00000705 28                    1282 	.db #0x28	; 40
    00000706 14                    1283 	.db #0x14	; 20
    00000707                       1284 _green_pal:
    00000707 3F                    1285 	.db #0x3f	; 63
    00000708 2E                    1286 	.db #0x2e	; 46
    00000709 08                    1287 	.db #0x08	; 8
    0000070A 04                    1288 	.db #0x04	; 4
                                   1289 	.area _CODE
                                   1290 	.area _INITIALIZER
    00000000                       1291 __xinit__joyp:
    00000000 00                    1292 	.db #0x00	; 0
    00000001                       1293 __xinit__old_joyp:
    00000001 00                    1294 	.db #0x00	; 0
                                   1295 	.area _CABS (ABS)
