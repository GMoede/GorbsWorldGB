                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.1 #15267 (Mac OS X ppc)
                                      4 ;--------------------------------------------------------
                                      5 	.module main
                                      6 	
                                      7 ;--------------------------------------------------------
                                      8 ; Public variables in this module
                                      9 ;--------------------------------------------------------
                                     10 	.globl _main
                                     11 	.globl _DrawText
                                     12 	.globl _GetCharacterVRamTile
                                     13 	.globl _get_bkg_xy_addr
                                     14 	.globl _set_vram_byte
                                     15 	.globl _fill_rect_compat
                                     16 	.globl _set_native_tile_data
                                     17 ;--------------------------------------------------------
                                     18 ; special function registers
                                     19 ;--------------------------------------------------------
                         00000000    20 _GG_STATE	=	0x0000
                         00000001    21 _GG_EXT_7BIT	=	0x0001
                         00000002    22 _GG_EXT_CTL	=	0x0002
                         00000003    23 _GG_SIO_SEND	=	0x0003
                         00000004    24 _GG_SIO_RECV	=	0x0004
                         00000005    25 _GG_SIO_CTL	=	0x0005
                         00000006    26 _GG_SOUND_PAN	=	0x0006
                         0000003E    27 _MEMORY_CTL	=	0x003e
                         0000003F    28 _JOY_CTL	=	0x003f
                         0000007E    29 _VCOUNTER	=	0x007e
                         0000007F    30 _PSG	=	0x007f
                         0000007F    31 _HCOUNTER	=	0x007f
                         000000BE    32 _VDP_DATA	=	0x00be
                         000000BF    33 _VDP_CMD	=	0x00bf
                         000000BF    34 _VDP_STATUS	=	0x00bf
                         000000DC    35 _JOY_PORT1	=	0x00dc
                         000000DD    36 _JOY_PORT2	=	0x00dd
                         000000F0    37 _FMADDRESS	=	0x00f0
                         000000F1    38 _FMDATA	=	0x00f1
                         000000F2    39 _AUDIOCTRL	=	0x00f2
                                     40 ;--------------------------------------------------------
                                     41 ; ram data
                                     42 ;--------------------------------------------------------
                                     43 	.area _DATA
                         0000FFFC    44 _RAM_CONTROL	=	0xfffc
                         0000FFF8    45 _GLASSES_3D	=	0xfff8
                         0000FFFD    46 _MAP_FRAME0	=	0xfffd
                         0000FFFE    47 _MAP_FRAME1	=	0xfffe
                         0000FFFF    48 _MAP_FRAME2	=	0xffff
                                     49 ;--------------------------------------------------------
                                     50 ; ram data
                                     51 ;--------------------------------------------------------
                                     52 	.area _INITIALIZED
                                     53 ;--------------------------------------------------------
                                     54 ; absolute external ram data
                                     55 ;--------------------------------------------------------
                                     56 	.area _DABS (ABS)
                                     57 ;--------------------------------------------------------
                                     58 ; global & static initialisations
                                     59 ;--------------------------------------------------------
                                     60 	.area _HOME
                                     61 	.area _GSINIT
                                     62 	.area _GSFINAL
                                     63 	.area _GSINIT
                                     64 ;--------------------------------------------------------
                                     65 ; Home
                                     66 ;--------------------------------------------------------
                                     67 	.area _HOME
                                     68 	.area _HOME
                                     69 ;--------------------------------------------------------
                                     70 ; code
                                     71 ;--------------------------------------------------------
                                     72 	.area _CODE
                                     73 ;src/main.c:6: uint8_t GetCharacterVRamTile(char character) {
                                     74 ;	---------------------------------
                                     75 ; Function GetCharacterVRamTile
                                     76 ; ---------------------------------
    00000000                         77 _GetCharacterVRamTile::
    00000000 47               [ 4]   78 	ld	b, a
                                     79 ;src/main.c:8: uint8_t vramTile=0;
    00000001 0E 00            [ 7]   80 	ld	c, #0x00
                                     81 ;src/main.c:14: if      (character >= 'a' && character <= 'z') vramTile = (character - 'a') + 1;
    00000003 78               [ 4]   82 	ld	a, b
    00000004 EE 80            [ 7]   83 	xor	a, #0x80
    00000006 D6 E1            [ 7]   84 	sub	a, #0xe1
    00000008 38 11            [12]   85 	jr	C, 00120$
    0000000A 3E 7A            [ 7]   86 	ld	a, #0x7a
    0000000C 90               [ 4]   87 	sub	a, b
    0000000D E2r12r00         [10]   88 	jp	PO, 00230$
    00000010 EE 80            [ 7]   89 	xor	a, #0x80
    00000012                         90 00230$:
    00000012 FAr1Br00         [10]   91 	jp	M, 00120$
    00000015 78               [ 4]   92 	ld	a, b
    00000016 C6 A0            [ 7]   93 	add	a, #0xa0
    00000018 4F               [ 4]   94 	ld	c, a
    00000019 18 79            [12]   95 	jr	00121$
    0000001B                         96 00120$:
                                     97 ;src/main.c:15: else if (character >= 'A' && character <= 'Z') vramTile = (character - 'A') + 1;
    0000001B 78               [ 4]   98 	ld	a, b
    0000001C EE 80            [ 7]   99 	xor	a, #0x80
    0000001E D6 C1            [ 7]  100 	sub	a, #0xc1
    00000020 38 11            [12]  101 	jr	C, 00116$
    00000022 3E 5A            [ 7]  102 	ld	a, #0x5a
    00000024 90               [ 4]  103 	sub	a, b
    00000025 E2r2Ar00         [10]  104 	jp	PO, 00231$
    00000028 EE 80            [ 7]  105 	xor	a, #0x80
    0000002A                        106 00231$:
    0000002A FAr33r00         [10]  107 	jp	M, 00116$
    0000002D 78               [ 4]  108 	ld	a, b
    0000002E C6 C0            [ 7]  109 	add	a, #0xc0
    00000030 4F               [ 4]  110 	ld	c, a
    00000031 18 61            [12]  111 	jr	00121$
    00000033                        112 00116$:
                                    113 ;src/main.c:16: else if (character >= '0' && character <= '9') vramTile = (character - '0') + 27;
    00000033 78               [ 4]  114 	ld	a, b
    00000034 EE 80            [ 7]  115 	xor	a, #0x80
    00000036 D6 B0            [ 7]  116 	sub	a, #0xb0
    00000038 38 11            [12]  117 	jr	C, 00112$
    0000003A 3E 39            [ 7]  118 	ld	a, #0x39
    0000003C 90               [ 4]  119 	sub	a, b
    0000003D E2r42r00         [10]  120 	jp	PO, 00232$
    00000040 EE 80            [ 7]  121 	xor	a, #0x80
    00000042                        122 00232$:
    00000042 FAr4Br00         [10]  123 	jp	M, 00112$
    00000045 78               [ 4]  124 	ld	a, b
    00000046 C6 EB            [ 7]  125 	add	a, #0xeb
    00000048 4F               [ 4]  126 	ld	c, a
    00000049 18 49            [12]  127 	jr	00121$
    0000004B                        128 00112$:
                                    129 ;src/main.c:18: switch(character) {
    0000004B 78               [ 4]  130 	ld	a,b
    0000004C FE 21            [ 7]  131 	cp	a,#0x21
    0000004E 28 22            [12]  132 	jr	Z, 00101$
    00000050 FE 2C            [ 7]  133 	cp	a,#0x2c
    00000052 28 32            [12]  134 	jr	Z, 00106$
    00000054 FE 2E            [ 7]  135 	cp	a,#0x2e
    00000056 28 32            [12]  136 	jr	Z, 00107$
    00000058 FE 2F            [ 7]  137 	cp	a,#0x2f
    0000005A 28 22            [12]  138 	jr	Z, 00104$
    0000005C FE 3A            [ 7]  139 	cp	a,#0x3a
    0000005E 28 16            [12]  140 	jr	Z, 00102$
    00000060 FE 3C            [ 7]  141 	cp	a,#0x3c
    00000062 28 2A            [12]  142 	jr	Z, 00108$
    00000064 FE 3D            [ 7]  143 	cp	a,#0x3d
    00000066 28 1A            [12]  144 	jr	Z, 00105$
    00000068 FE 3E            [ 7]  145 	cp	a,#0x3e
    0000006A 28 26            [12]  146 	jr	Z, 00109$
    0000006C D6 3F            [ 7]  147 	sub	a, #0x3f
    0000006E 28 0A            [12]  148 	jr	Z, 00103$
    00000070 18 22            [12]  149 	jr	00121$
                                    150 ;src/main.c:19: case '!': vramTile = 37; break;
    00000072                        151 00101$:
    00000072 0E 25            [ 7]  152 	ld	c, #0x25
    00000074 18 1E            [12]  153 	jr	00121$
                                    154 ;src/main.c:20: case ':': vramTile = 38; break;
    00000076                        155 00102$:
    00000076 0E 26            [ 7]  156 	ld	c, #0x26
    00000078 18 1A            [12]  157 	jr	00121$
                                    158 ;src/main.c:21: case '?': vramTile = 39; break;
    0000007A                        159 00103$:
    0000007A 0E 27            [ 7]  160 	ld	c, #0x27
    0000007C 18 16            [12]  161 	jr	00121$
                                    162 ;src/main.c:22: case '/': vramTile = 40; break;
    0000007E                        163 00104$:
    0000007E 0E 28            [ 7]  164 	ld	c, #0x28
    00000080 18 12            [12]  165 	jr	00121$
                                    166 ;src/main.c:23: case '=': vramTile = 41; break;
    00000082                        167 00105$:
    00000082 0E 29            [ 7]  168 	ld	c, #0x29
    00000084 18 0E            [12]  169 	jr	00121$
                                    170 ;src/main.c:24: case ',': vramTile = 42; break;
    00000086                        171 00106$:
    00000086 0E 2A            [ 7]  172 	ld	c, #0x2a
    00000088 18 0A            [12]  173 	jr	00121$
                                    174 ;src/main.c:25: case '.': vramTile = 43; break;
    0000008A                        175 00107$:
    0000008A 0E 2B            [ 7]  176 	ld	c, #0x2b
    0000008C 18 06            [12]  177 	jr	00121$
                                    178 ;src/main.c:26: case '<': vramTile = 44; break;
    0000008E                        179 00108$:
    0000008E 0E 2C            [ 7]  180 	ld	c, #0x2c
    00000090 18 02            [12]  181 	jr	00121$
                                    182 ;src/main.c:27: case '>': vramTile = 45; break;
    00000092                        183 00109$:
    00000092 0E 2D            [ 7]  184 	ld	c, #0x2d
                                    185 ;src/main.c:28: }
    00000094                        186 00121$:
                                    187 ;src/main.c:31: return vramTile;
    00000094 79               [ 4]  188 	ld	a, c
                                    189 ;src/main.c:33: }
    00000095 C9               [10]  190 	ret
                                    191 ;src/main.c:35: void DrawText(uint8_t column, uint8_t row, char* text){
                                    192 ;	---------------------------------
                                    193 ; Function DrawText
                                    194 ; ---------------------------------
    00000096                        195 _DrawText::
    00000096 DD E5            [15]  196 	push	ix
    00000098 DD 21 00 00      [14]  197 	ld	ix,#0
    0000009C DD 39            [15]  198 	add	ix,sp
    0000009E 45               [ 4]  199 	ld	b, l
                                    200 ;src/main.c:38: uint8_t* vramAddress = get_bkg_xy_addr(column,row);
    0000009F C5               [11]  201 	push	bc
    000000A0 33               [ 6]  202 	inc	sp
    000000A1 F5               [11]  203 	push	af
    000000A2 33               [ 6]  204 	inc	sp
    000000A3 CDr00r00         [17]  205 	call	_get_bkg_xy_addr
    000000A6 EB               [ 4]  206 	ex	de, hl
                                    207 ;src/main.c:42: while(text[index]!='\0'){
    000000A7 01 00 00         [10]  208 	ld	bc, #0x0000
    000000AA                        209 00101$:
    000000AA DD 6E 04         [19]  210 	ld	l, 4 (ix)
    000000AD DD 66 05         [19]  211 	ld	h, 5 (ix)
    000000B0 09               [11]  212 	add	hl, bc
    000000B1 7E               [ 7]  213 	ld	a, (hl)
    000000B2 B7               [ 4]  214 	or	a, a
    000000B3 28 25            [12]  215 	jr	Z, 00104$
                                    216 ;src/main.c:44: char character = text[index];
                                    217 ;src/main.c:48: uint8_t vramTile = GetCharacterVRamTile(character);
    000000B5 C5               [11]  218 	push	bc
    000000B6 D5               [11]  219 	push	de
    000000B7 CDr00r00         [17]  220 	call	_GetCharacterVRamTile
    000000BA D1               [10]  221 	pop	de
    000000BB C1               [10]  222 	pop	bc
                                    223 ;src/main.c:50: set_vram_byte(vramAddress++,vramTile);
    000000BC 6B               [ 4]  224 	ld	l, e
    000000BD 62               [ 4]  225 	ld	h, d
    000000BE 13               [ 6]  226 	inc	de
    000000BF C5               [11]  227 	push	bc
    000000C0 D5               [11]  228 	push	de
    000000C1 F5               [11]  229 	push	af
    000000C2 33               [ 6]  230 	inc	sp
    000000C3 E5               [11]  231 	push	hl
    000000C4 CDr00r00         [17]  232 	call	_set_vram_byte
    000000C7 D1               [10]  233 	pop	de
    000000C8 C1               [10]  234 	pop	bc
                                    235 ;src/main.c:53: set_vram_byte(vramAddress++,0);
    000000C9 6B               [ 4]  236 	ld	l, e
    000000CA 62               [ 4]  237 	ld	h, d
    000000CB 13               [ 6]  238 	inc	de
    000000CC C5               [11]  239 	push	bc
    000000CD D5               [11]  240 	push	de
    000000CE AF               [ 4]  241 	xor	a, a
    000000CF F5               [11]  242 	push	af
    000000D0 33               [ 6]  243 	inc	sp
    000000D1 E5               [11]  244 	push	hl
    000000D2 CDr00r00         [17]  245 	call	_set_vram_byte
    000000D5 D1               [10]  246 	pop	de
    000000D6 C1               [10]  247 	pop	bc
                                    248 ;src/main.c:56: index++;
    000000D7 03               [ 6]  249 	inc	bc
    000000D8 18 D0            [12]  250 	jr	00101$
    000000DA                        251 00104$:
                                    252 ;src/main.c:59: }
    000000DA DD E1            [14]  253 	pop	ix
    000000DC E1               [10]  254 	pop	hl
    000000DD F1               [10]  255 	pop	af
    000000DE E9               [ 4]  256 	jp	(hl)
                                    257 ;src/main.c:61: void main(void)
                                    258 ;	---------------------------------
                                    259 ; Function main
                                    260 ; ---------------------------------
    000000DF                        261 _main::
                                    262 ;src/main.c:65: set_native_tile_data(0,Font_TILE_COUNT,Font_tiles);
    000000DF 21r00r00         [10]  263 	ld	hl, #_Font_tiles
    000000E2 E5               [11]  264 	push	hl
    000000E3 11 2E 00         [10]  265 	ld	de, #0x002e
    000000E6 21 00 00         [10]  266 	ld	hl, #0x0000
    000000E9 CDr00r00         [17]  267 	call	_set_native_tile_data
                                    268 ;src/main.c:67: fill_bkg_rect(0,0,DEVICE_SCREEN_WIDTH,DEVICE_SCREEN_HEIGHT,0);
    000000EC 21 00 00         [10]  269 	ld	hl, #0x0000
    000000EF E5               [11]  270 	push	hl
    000000F0 21 14 12         [10]  271 	ld	hl, #0x1214
    000000F3 E5               [11]  272 	push	hl
    000000F4 21 00 00         [10]  273 	ld	hl, #0x00
    000000F7 E5               [11]  274 	push	hl
    000000F8 CDr00r00         [17]  275 	call	_fill_rect_compat
                                    276 ;src/main.c:70: DrawText(1,1,"GBDK Text Example");
    000000FB 21r06r01         [10]  277 	ld	hl, #___str_0
    000000FE E5               [11]  278 	push	hl
    000000FF 3E 01            [ 7]  279 	ld	a,#0x01
    00000101 6F               [ 4]  280 	ld	l,a
    00000102 CDr96r00         [17]  281 	call	_DrawText
                                    282 ;src/main.c:71: }
    00000105 C9               [10]  283 	ret
    00000106                        284 ___str_0:
    00000106 47 42 44 4B 20 54 65   285 	.ascii "GBDK Text Example"
             78 74 20 45 78 61 6D
             70 6C 65
    00000117 00                     286 	.db 0x00
                                    287 	.area _CODE
                                    288 	.area _INITIALIZER
                                    289 	.area _CABS (ABS)
